"use strict";var cov_20aut6ewqm=function(){var path="C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\rdc-received.contract.ts";var hash="8ed2d3969ca2a438f4367dd1a83b0a3b2d4a0c30";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\rdc-received.contract.ts",statementMap:{"0":{start:{line:2,column:17},end:{line:7,column:1}},"1":{start:{line:3,column:12},end:{line:3,column:28}},"2":{start:{line:3,column:34},end:{line:3,column:125}},"3":{start:{line:4,column:4},end:{line:5,column:150}},"4":{start:{line:4,column:79},end:{line:4,column:131}},"5":{start:{line:5,column:9},end:{line:5,column:150}},"6":{start:{line:5,column:22},end:{line:5,column:43}},"7":{start:{line:5,column:58},end:{line:5,column:150}},"8":{start:{line:5,column:81},end:{line:5,column:150}},"9":{start:{line:6,column:4},end:{line:6,column:66}},"10":{start:{line:8,column:17},end:{line:10,column:1}},"11":{start:{line:9,column:4},end:{line:9,column:109}},"12":{start:{line:9,column:79},end:{line:9,column:109}},"13":{start:{line:11,column:0},end:{line:11,column:62}},"14":{start:{line:12,column:30},end:{line:12,column:60}},"15":{start:{line:13,column:17},end:{line:13,column:37}},"16":{start:{line:14,column:23},end:{line:14,column:49}},"17":{start:{line:15,column:28},end:{line:15,column:59}},"18":{start:{line:16,column:15},end:{line:16,column:35}},"19":{start:{line:17,column:15},end:{line:17,column:70}},"20":{start:{line:18,column:26},end:{line:134,column:1}},"21":{start:{line:19,column:20},end:{line:19,column:75}},"22":{start:{line:22,column:8},end:{line:39,column:9}},"23":{start:{line:24,column:12},end:{line:26,column:13}},"24":{start:{line:25,column:16},end:{line:25,column:86}},"25":{start:{line:28,column:22},end:{line:28,column:24}},"26":{start:{line:29,column:12},end:{line:32,column:13}},"27":{start:{line:30,column:37},end:{line:30,column:119}},"28":{start:{line:31,column:16},end:{line:31,column:41}},"29":{start:{line:33,column:12},end:{line:33,column:23}},"30":{start:{line:36,column:12},end:{line:36,column:55}},"31":{start:{line:37,column:12},end:{line:37,column:28}},"32":{start:{line:38,column:12},end:{line:38,column:19}},"33":{start:{line:43,column:8},end:{line:132,column:9}},"34":{start:{line:45,column:12},end:{line:45,column:39}},"35":{start:{line:46,column:12},end:{line:48,column:13}},"36":{start:{line:47,column:16},end:{line:47,column:115}},"37":{start:{line:49,column:12},end:{line:51,column:13}},"38":{start:{line:49,column:55},end:{line:49,column:87}},"39":{start:{line:50,column:16},end:{line:50,column:129}},"40":{start:{line:52,column:25},end:{line:52,column:75}},"41":{start:{line:54,column:21},end:{line:54,column:74}},"42":{start:{line:55,column:26},end:{line:55,column:30}},"43":{start:{line:56,column:12},end:{line:61,column:13}},"44":{start:{line:57,column:16},end:{line:57,column:60}},"45":{start:{line:58,column:16},end:{line:58,column:48}},"46":{start:{line:59,column:16},end:{line:59,column:32}},"47":{start:{line:60,column:16},end:{line:60,column:58}},"48":{start:{line:63,column:12},end:{line:63,column:61}},"49":{start:{line:64,column:26},end:{line:64,column:91}},"50":{start:{line:65,column:12},end:{line:67,column:13}},"51":{start:{line:66,column:16},end:{line:66,column:72}},"52":{start:{line:68,column:12},end:{line:68,column:47}},"53":{start:{line:70,column:12},end:{line:70,column:62}},"54":{start:{line:71,column:30},end:{line:71,column:89}},"55":{start:{line:72,column:12},end:{line:74,column:13}},"56":{start:{line:73,column:16},end:{line:73,column:70}},"57":{start:{line:75,column:12},end:{line:75,column:51}},"58":{start:{line:77,column:12},end:{line:77,column:147}},"59":{start:{line:78,column:12},end:{line:111,column:13}},"60":{start:{line:80,column:16},end:{line:80,column:92}},"61":{start:{line:81,column:16},end:{line:89,column:19}},"62":{start:{line:82,column:46},end:{line:84,column:22}},"63":{start:{line:83,column:24},end:{line:83,column:156}},"64":{start:{line:85,column:20},end:{line:88,column:21}},"65":{start:{line:86,column:24},end:{line:86,column:84}},"66":{start:{line:87,column:24},end:{line:87,column:66}},"67":{start:{line:91,column:32},end:{line:100,column:22}},"68":{start:{line:92,column:46},end:{line:94,column:22}},"69":{start:{line:93,column:24},end:{line:93,column:156}},"70":{start:{line:95,column:20},end:{line:98,column:21}},"71":{start:{line:96,column:24},end:{line:96,column:93}},"72":{start:{line:97,column:24},end:{line:97,column:37}},"73":{start:{line:99,column:20},end:{line:99,column:31}},"74":{start:{line:101,column:16},end:{line:101,column:91}},"75":{start:{line:103,column:16},end:{line:106,column:17}},"76":{start:{line:104,column:20},end:{line:104,column:100}},"77":{start:{line:105,column:20},end:{line:105,column:55}},"78":{start:{line:109,column:16},end:{line:109,column:84}},"79":{start:{line:110,column:16},end:{line:110,column:87}},"80":{start:{line:113,column:12},end:{line:113,column:59}},"81":{start:{line:114,column:28},end:{line:114,column:110}},"82":{start:{line:115,column:12},end:{line:115,column:59}},"83":{start:{line:117,column:12},end:{line:124,column:13}},"84":{start:{line:118,column:16},end:{line:118,column:62}},"85":{start:{line:119,column:16},end:{line:119,column:47}},"86":{start:{line:122,column:16},end:{line:122,column:68}},"87":{start:{line:123,column:16},end:{line:123,column:47}},"88":{start:{line:125,column:12},end:{line:125,column:122}},"89":{start:{line:126,column:12},end:{line:126,column:29}},"90":{start:{line:129,column:12},end:{line:129,column:76}},"91":{start:{line:130,column:12},end:{line:130,column:28}},"92":{start:{line:131,column:12},end:{line:131,column:19}},"93":{start:{line:135,column:0},end:{line:142,column:63}},"94":{start:{line:143,column:0},end:{line:151,column:59}},"95":{start:{line:152,column:0},end:{line:155,column:24}},"96":{start:{line:156,column:0},end:{line:156,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:46},end:{line:2,column:47}},loc:{start:{line:2,column:87},end:{line:7,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:46},end:{line:8,column:47}},loc:{start:{line:8,column:62},end:{line:10,column:1}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:4},end:{line:19,column:5}},loc:{start:{line:19,column:18},end:{line:19,column:77}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:4},end:{line:21,column:5}},loc:{start:{line:21,column:62},end:{line:40,column:5}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:42,column:4},end:{line:42,column:5}},loc:{start:{line:42,column:61},end:{line:133,column:5}},line:42},"5":{name:"(anonymous_5)",decl:{start:{line:49,column:40},end:{line:49,column:41}},loc:{start:{line:49,column:53},end:{line:49,column:89}},line:49},"6":{name:"(anonymous_6)",decl:{start:{line:81,column:43},end:{line:81,column:44}},loc:{start:{line:81,column:59},end:{line:89,column:17}},line:81},"7":{name:"(anonymous_7)",decl:{start:{line:82,column:72},end:{line:82,column:73}},loc:{start:{line:82,column:103},end:{line:84,column:21}},line:82},"8":{name:"(anonymous_8)",decl:{start:{line:91,column:58},end:{line:91,column:59}},loc:{start:{line:91,column:79},end:{line:100,column:17}},line:91},"9":{name:"(anonymous_9)",decl:{start:{line:92,column:72},end:{line:92,column:73}},loc:{start:{line:92,column:103},end:{line:94,column:21}},line:92}},branchMap:{"0":{loc:{start:{line:2,column:17},end:{line:7,column:1}},type:"binary-expr",locations:[{start:{line:2,column:18},end:{line:2,column:22}},{start:{line:2,column:26},end:{line:2,column:41}},{start:{line:2,column:46},end:{line:7,column:1}}],line:2},"1":{loc:{start:{line:3,column:34},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:42},end:{line:3,column:48}},{start:{line:3,column:51},end:{line:3,column:125}}],line:3},"2":{loc:{start:{line:3,column:51},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:67},end:{line:3,column:118}},{start:{line:3,column:121},end:{line:3,column:125}}],line:3},"3":{loc:{start:{line:4,column:4},end:{line:5,column:150}},type:"if",locations:[{start:{line:4,column:4},end:{line:5,column:150}},{start:{line:4,column:4},end:{line:5,column:150}}],line:4},"4":{loc:{start:{line:4,column:8},end:{line:4,column:77}},type:"binary-expr",locations:[{start:{line:4,column:8},end:{line:4,column:35}},{start:{line:4,column:39},end:{line:4,column:77}}],line:4},"5":{loc:{start:{line:5,column:58},end:{line:5,column:150}},type:"if",locations:[{start:{line:5,column:58},end:{line:5,column:150}},{start:{line:5,column:58},end:{line:5,column:150}}],line:5},"6":{loc:{start:{line:5,column:85},end:{line:5,column:149}},type:"binary-expr",locations:[{start:{line:5,column:86},end:{line:5,column:143}},{start:{line:5,column:148},end:{line:5,column:149}}],line:5},"7":{loc:{start:{line:5,column:86},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:94},end:{line:5,column:98}},{start:{line:5,column:101},end:{line:5,column:143}}],line:5},"8":{loc:{start:{line:5,column:101},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:109},end:{line:5,column:126}},{start:{line:5,column:129},end:{line:5,column:143}}],line:5},"9":{loc:{start:{line:6,column:11},end:{line:6,column:62}},type:"binary-expr",locations:[{start:{line:6,column:11},end:{line:6,column:16}},{start:{line:6,column:20},end:{line:6,column:21}},{start:{line:6,column:25},end:{line:6,column:62}}],line:6},"10":{loc:{start:{line:8,column:17},end:{line:10,column:1}},type:"binary-expr",locations:[{start:{line:8,column:18},end:{line:8,column:22}},{start:{line:8,column:26},end:{line:8,column:41}},{start:{line:8,column:46},end:{line:10,column:1}}],line:8},"11":{loc:{start:{line:9,column:4},end:{line:9,column:109}},type:"if",locations:[{start:{line:9,column:4},end:{line:9,column:109}},{start:{line:9,column:4},end:{line:9,column:109}}],line:9},"12":{loc:{start:{line:9,column:8},end:{line:9,column:77}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:35}},{start:{line:9,column:39},end:{line:9,column:77}}],line:9},"13":{loc:{start:{line:24,column:12},end:{line:26,column:13}},type:"if",locations:[{start:{line:24,column:12},end:{line:26,column:13}},{start:{line:24,column:12},end:{line:26,column:13}}],line:24},"14":{loc:{start:{line:46,column:12},end:{line:48,column:13}},type:"if",locations:[{start:{line:46,column:12},end:{line:48,column:13}},{start:{line:46,column:12},end:{line:48,column:13}}],line:46},"15":{loc:{start:{line:49,column:12},end:{line:51,column:13}},type:"if",locations:[{start:{line:49,column:12},end:{line:51,column:13}},{start:{line:49,column:12},end:{line:51,column:13}}],line:49},"16":{loc:{start:{line:56,column:12},end:{line:61,column:13}},type:"if",locations:[{start:{line:56,column:12},end:{line:61,column:13}},{start:{line:56,column:12},end:{line:61,column:13}}],line:56},"17":{loc:{start:{line:65,column:12},end:{line:67,column:13}},type:"if",locations:[{start:{line:65,column:12},end:{line:67,column:13}},{start:{line:65,column:12},end:{line:67,column:13}}],line:65},"18":{loc:{start:{line:72,column:12},end:{line:74,column:13}},type:"if",locations:[{start:{line:72,column:12},end:{line:74,column:13}},{start:{line:72,column:12},end:{line:74,column:13}}],line:72},"19":{loc:{start:{line:77,column:34},end:{line:77,column:120}},type:"cond-expr",locations:[{start:{line:77,column:98},end:{line:77,column:104}},{start:{line:77,column:107},end:{line:77,column:120}}],line:77},"20":{loc:{start:{line:77,column:35},end:{line:77,column:94}},type:"binary-expr",locations:[{start:{line:77,column:35},end:{line:77,column:64}},{start:{line:77,column:68},end:{line:77,column:94}}],line:77},"21":{loc:{start:{line:78,column:12},end:{line:111,column:13}},type:"if",locations:[{start:{line:78,column:12},end:{line:111,column:13}},{start:{line:78,column:12},end:{line:111,column:13}}],line:78},"22":{loc:{start:{line:78,column:16},end:{line:78,column:75}},type:"binary-expr",locations:[{start:{line:78,column:16},end:{line:78,column:45}},{start:{line:78,column:49},end:{line:78,column:75}}],line:78},"23":{loc:{start:{line:83,column:31},end:{line:83,column:155}},type:"binary-expr",locations:[{start:{line:83,column:31},end:{line:83,column:52}},{start:{line:83,column:56},end:{line:83,column:77}},{start:{line:83,column:81},end:{line:83,column:112}},{start:{line:83,column:116},end:{line:83,column:155}}],line:83},"24":{loc:{start:{line:85,column:20},end:{line:88,column:21}},type:"if",locations:[{start:{line:85,column:20},end:{line:88,column:21}},{start:{line:85,column:20},end:{line:88,column:21}}],line:85},"25":{loc:{start:{line:93,column:31},end:{line:93,column:155}},type:"binary-expr",locations:[{start:{line:93,column:31},end:{line:93,column:52}},{start:{line:93,column:56},end:{line:93,column:77}},{start:{line:93,column:81},end:{line:93,column:112}},{start:{line:93,column:116},end:{line:93,column:155}}],line:93},"26":{loc:{start:{line:95,column:20},end:{line:98,column:21}},type:"if",locations:[{start:{line:95,column:20},end:{line:98,column:21}},{start:{line:95,column:20},end:{line:98,column:21}}],line:95},"27":{loc:{start:{line:103,column:16},end:{line:106,column:17}},type:"if",locations:[{start:{line:103,column:16},end:{line:106,column:17}},{start:{line:103,column:16},end:{line:106,column:17}}],line:103},"28":{loc:{start:{line:117,column:12},end:{line:124,column:13}},type:"if",locations:[{start:{line:117,column:12},end:{line:124,column:13}},{start:{line:117,column:12},end:{line:124,column:13}}],line:117}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0,0,0],"24":[0,0],"25":[0,0,0,0],"26":[0,0],"27":[0,0],"28":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"8ed2d3969ca2a438f4367dd1a83b0a3b2d4a0c30"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var __decorate=(cov_20aut6ewqm.s[0]++,(cov_20aut6ewqm.b[0][0]++,this)&&(cov_20aut6ewqm.b[0][1]++,this.__decorate)||(cov_20aut6ewqm.b[0][2]++,function(decorators,target,key,desc){cov_20aut6ewqm.f[0]++;var c=(cov_20aut6ewqm.s[1]++,arguments.length),r=(cov_20aut6ewqm.s[2]++,c<3?(cov_20aut6ewqm.b[1][0]++,target):(cov_20aut6ewqm.b[1][1]++,desc===null?(cov_20aut6ewqm.b[2][0]++,desc=Object.getOwnPropertyDescriptor(target,key)):(cov_20aut6ewqm.b[2][1]++,desc))),d;cov_20aut6ewqm.s[3]++;if((cov_20aut6ewqm.b[4][0]++,typeof Reflect==="object")&&(cov_20aut6ewqm.b[4][1]++,typeof Reflect.decorate==="function")){cov_20aut6ewqm.b[3][0]++;cov_20aut6ewqm.s[4]++;r=Reflect.decorate(decorators,target,key,desc);}else{cov_20aut6ewqm.b[3][1]++;cov_20aut6ewqm.s[5]++;for(var i=(cov_20aut6ewqm.s[6]++,decorators.length-1);i>=0;i--){cov_20aut6ewqm.s[7]++;if(d=decorators[i]){cov_20aut6ewqm.b[5][0]++;cov_20aut6ewqm.s[8]++;r=(cov_20aut6ewqm.b[6][0]++,c<3?(cov_20aut6ewqm.b[7][0]++,d(r)):(cov_20aut6ewqm.b[7][1]++,c>3?(cov_20aut6ewqm.b[8][0]++,d(target,key,r)):(cov_20aut6ewqm.b[8][1]++,d(target,key))))||(cov_20aut6ewqm.b[6][1]++,r);}else{cov_20aut6ewqm.b[5][1]++;}}}cov_20aut6ewqm.s[9]++;return(cov_20aut6ewqm.b[9][0]++,c>3)&&(cov_20aut6ewqm.b[9][1]++,r)&&(cov_20aut6ewqm.b[9][2]++,Object.defineProperty(target,key,r)),r;}));var __metadata=(cov_20aut6ewqm.s[10]++,(cov_20aut6ewqm.b[10][0]++,this)&&(cov_20aut6ewqm.b[10][1]++,this.__metadata)||(cov_20aut6ewqm.b[10][2]++,function(k,v){cov_20aut6ewqm.f[1]++;cov_20aut6ewqm.s[11]++;if((cov_20aut6ewqm.b[12][0]++,typeof Reflect==="object")&&(cov_20aut6ewqm.b[12][1]++,typeof Reflect.metadata==="function")){cov_20aut6ewqm.b[11][0]++;cov_20aut6ewqm.s[12]++;return Reflect.metadata(k,v);}else{cov_20aut6ewqm.b[11][1]++;}}));cov_20aut6ewqm.s[13]++;Object.defineProperty(exports,"__esModule",{value:true});const fabric_contract_api_1=(cov_20aut6ewqm.s[14]++,require("fabric-contract-api"));const models_1=(cov_20aut6ewqm.s[15]++,require("../models"));const repositories_1=(cov_20aut6ewqm.s[16]++,require("../repositories"));const processing_engine_1=(cov_20aut6ewqm.s[17]++,require("../processing-engine"));const Logger=(cov_20aut6ewqm.s[18]++,require('../logger'));const logger=(cov_20aut6ewqm.s[19]++,Logger.getLogger('./contracts/ifc-shipped.contract.ts'));cov_20aut6ewqm.s[20]++;let RDCReceivedContract=class RDCReceivedContract extends fabric_contract_api_1.Contract{constructor(){cov_20aut6ewqm.f[2]++;cov_20aut6ewqm.s[21]++;super("com.homedepot.procurement.RDCReceivedContract");}// Used to bulk merge several records of new RDCReceived data with existing RDCReceived data
async bulkSaveRDCReceived(ctx,newListOfRDCReceivedLists){cov_20aut6ewqm.f[3]++;cov_20aut6ewqm.s[22]++;try{cov_20aut6ewqm.s[23]++;// Sanity-checks: list.length > 0
if(newListOfRDCReceivedLists.length===0){cov_20aut6ewqm.b[13][0]++;cov_20aut6ewqm.s[24]++;throw new Error(`bulkSaveRDCReceived was called with 0 RDCReceiveds`);}else{cov_20aut6ewqm.b[13][1]++;}// Add each set of PO items to the blockchain, one PONumber at a time
let aps=(cov_20aut6ewqm.s[25]++,[]);cov_20aut6ewqm.s[26]++;for(let currentItemsList of newListOfRDCReceivedLists){let currentSavedAP=(cov_20aut6ewqm.s[27]++,await this.saveRDCReceived(ctx,currentItemsList.PONumber,currentItemsList.Items));cov_20aut6ewqm.s[28]++;aps.push(currentSavedAP);}cov_20aut6ewqm.s[29]++;return aps;}catch(e){cov_20aut6ewqm.s[30]++;logger.error(`bulkSaveRDCReceived failed`);cov_20aut6ewqm.s[31]++;logger.error(e);cov_20aut6ewqm.s[32]++;return;}}// Used to merge new RDCReceived data with existing RDCReceived data
async saveRDCReceived(ctx,poNumber,newRDCReceivedList){cov_20aut6ewqm.f[4]++;cov_20aut6ewqm.s[33]++;try{cov_20aut6ewqm.s[34]++;// Sanity-checks: rrlist.length > 0, all items in rrlist have PONumber=poNumber
poNumber=poNumber.trim();cov_20aut6ewqm.s[35]++;if(newRDCReceivedList.length===0){cov_20aut6ewqm.b[14][0]++;cov_20aut6ewqm.s[36]++;throw new Error(`saveRDCReceived was called with 0 RDCReceived items, for PONumber '${poNumber}'`);}else{cov_20aut6ewqm.b[14][1]++;}cov_20aut6ewqm.s[37]++;if(newRDCReceivedList.some((v,i,l)=>{cov_20aut6ewqm.f[5]++;cov_20aut6ewqm.s[38]++;return v.PONumber!=poNumber;})){cov_20aut6ewqm.b[15][0]++;cov_20aut6ewqm.s[39]++;throw new Error(`saveRDCReceived was called with some RDCReceived items that do not have PONUmber '${poNumber}`);}else{cov_20aut6ewqm.b[15][1]++;}let apRepo=(cov_20aut6ewqm.s[40]++,new repositories_1.AssetProcurementRepository(ctx));// Retrieve or create the AssetProcurement record
let ap=(cov_20aut6ewqm.s[41]++,new models_1.AssetProcurement({PONumber:poNumber}));let apIsNew=(cov_20aut6ewqm.s[42]++,true);cov_20aut6ewqm.s[43]++;if((await apRepo.exists(poNumber))==true){cov_20aut6ewqm.b[16][0]++;cov_20aut6ewqm.s[44]++;logger.debug(`PONumber ${poNumber} exists`);cov_20aut6ewqm.s[45]++;ap=await apRepo.get(poNumber);cov_20aut6ewqm.s[46]++;apIsNew=false;cov_20aut6ewqm.s[47]++;logger.debug('Retreived AP from storage');}else{cov_20aut6ewqm.b[16][1]++;}// Get the list of UnitOfMeasure data
cov_20aut6ewqm.s[48]++;logger.debug('Retrieving UOM data from storage');let uomList=(cov_20aut6ewqm.s[49]++,await new repositories_1.UnitOfMeasureListRepository(ctx).get());cov_20aut6ewqm.s[50]++;if(uomList===undefined){cov_20aut6ewqm.b[17][0]++;cov_20aut6ewqm.s[51]++;uomList=new models_1.UnitOfMeasureList({Items:[]});}else{cov_20aut6ewqm.b[17][1]++;}cov_20aut6ewqm.s[52]++;logger.debug(uomList.Items.length);// Retrieve the current ADR Rule data
cov_20aut6ewqm.s[53]++;logger.debug('Retrieving ADR Rules from storage');let adrRuleList=(cov_20aut6ewqm.s[54]++,await new repositories_1.ADRRuleListRepository(ctx).get());cov_20aut6ewqm.s[55]++;if(adrRuleList===undefined){cov_20aut6ewqm.b[18][0]++;cov_20aut6ewqm.s[56]++;adrRuleList=new models_1.ADRRuleList({Items:[]});}else{cov_20aut6ewqm.b[18][1]++;}cov_20aut6ewqm.s[57]++;logger.debug(adrRuleList.Items.length);// Merge the existing RDCReceived data with the new data
cov_20aut6ewqm.s[58]++;logger.debug('We '+((cov_20aut6ewqm.b[20][0]++,ap.RDCReceiveds!==undefined)&&(cov_20aut6ewqm.b[20][1]++,ap.RDCReceiveds.length>0)?(cov_20aut6ewqm.b[19][0]++,'have'):(cov_20aut6ewqm.b[19][1]++,'do not have'))+' RR data for the AP');cov_20aut6ewqm.s[59]++;if((cov_20aut6ewqm.b[22][0]++,ap.RDCReceiveds!==undefined)&&(cov_20aut6ewqm.b[22][1]++,ap.RDCReceiveds.length>0)){cov_20aut6ewqm.b[21][0]++;cov_20aut6ewqm.s[60]++;// Merge any records that match on key identifier fields
logger.debug(`Starting with ${newRDCReceivedList.length} new RDCReceiveds`);cov_20aut6ewqm.s[61]++;newRDCReceivedList.forEach((vc,ic,lc)=>{cov_20aut6ewqm.f[6]++;let existingRecordIndex=(cov_20aut6ewqm.s[62]++,ap.RDCReceiveds.findIndex((innerVC,innerIC,innerLC)=>{cov_20aut6ewqm.f[7]++;cov_20aut6ewqm.s[63]++;return(cov_20aut6ewqm.b[23][0]++,vc.RDC==innerVC.RDC)&&(cov_20aut6ewqm.b[23][1]++,vc.SKU==innerVC.SKU)&&(cov_20aut6ewqm.b[23][2]++,vc.PONumber==innerVC.PONumber)&&(cov_20aut6ewqm.b[23][3]++,vc.KeyRecNumber==innerVC.KeyRecNumber);}));cov_20aut6ewqm.s[64]++;if(existingRecordIndex>-1){cov_20aut6ewqm.b[24][0]++;cov_20aut6ewqm.s[65]++;logger.debug('Found a new RR that matched an existing one');cov_20aut6ewqm.s[66]++;ap.RDCReceiveds[existingRecordIndex]=vc;}else{cov_20aut6ewqm.b[24][1]++;}});// Deterimine all records that are new and do not match any existing records
let uniqueRRs=(cov_20aut6ewqm.s[67]++,newRDCReceivedList.reduce((pac,vc,ic,lc)=>{cov_20aut6ewqm.f[8]++;let existingRecordIndex=(cov_20aut6ewqm.s[68]++,ap.RDCReceiveds.findIndex((innerVC,innerIC,innerLC)=>{cov_20aut6ewqm.f[9]++;cov_20aut6ewqm.s[69]++;return(cov_20aut6ewqm.b[25][0]++,vc.RDC==innerVC.RDC)&&(cov_20aut6ewqm.b[25][1]++,vc.SKU==innerVC.SKU)&&(cov_20aut6ewqm.b[25][2]++,vc.PONumber==innerVC.PONumber)&&(cov_20aut6ewqm.b[25][3]++,vc.KeyRecNumber==innerVC.KeyRecNumber);}));cov_20aut6ewqm.s[70]++;if(existingRecordIndex==-1){cov_20aut6ewqm.b[26][0]++;cov_20aut6ewqm.s[71]++;logger.debug('Found a new RR that does not match the existing ones');cov_20aut6ewqm.s[72]++;pac.push(vc);}else{cov_20aut6ewqm.b[26][1]++;}cov_20aut6ewqm.s[73]++;return pac;},[]));cov_20aut6ewqm.s[74]++;logger.debug(`Ended up with ${uniqueRRs.length} totally new RDCReceiveds`);// If we found some new records to add, Append new records to the existing ones
cov_20aut6ewqm.s[75]++;if(uniqueRRs.length>0){cov_20aut6ewqm.b[27][0]++;cov_20aut6ewqm.s[76]++;logger.debug('Adding the final list of unique RRs to the existing list of RRs');cov_20aut6ewqm.s[77]++;ap.RDCReceiveds.push(...uniqueRRs);}else{cov_20aut6ewqm.b[27][1]++;}}else{cov_20aut6ewqm.b[21][1]++;cov_20aut6ewqm.s[78]++;logger.debug('Adding all new RRs since there are no existing RRs.');cov_20aut6ewqm.s[79]++;ap.setStageDetails(models_1.StageType.RDCReceived,newRDCReceivedList);}// Run this through the processing engine (FSM)
cov_20aut6ewqm.s[80]++;logger.debug('Starting the processing engine');let updatedAP=(cov_20aut6ewqm.s[81]++,processing_engine_1.ProcessingEngine.startProcessing(ap,{uomList,adrRuleList}));cov_20aut6ewqm.s[82]++;logger.debug('Finished the processing engine');// Save the AssetProcurement record
cov_20aut6ewqm.s[83]++;if(apIsNew){cov_20aut6ewqm.b[28][0]++;cov_20aut6ewqm.s[84]++;logger.debug('Attempting to create a new AP');cov_20aut6ewqm.s[85]++;await apRepo.create(updatedAP);}else{cov_20aut6ewqm.b[28][1]++;cov_20aut6ewqm.s[86]++;logger.debug('Attempting to update an existing AP');cov_20aut6ewqm.s[87]++;await apRepo.update(updatedAP);}cov_20aut6ewqm.s[88]++;logger.debug(`saveRDCReceived saved ${newRDCReceivedList.length} RDCReceived items for PONumber ${poNumber}`);cov_20aut6ewqm.s[89]++;return updatedAP;}catch(e){cov_20aut6ewqm.s[90]++;logger.error(`saveRDCReceived failed for PONumber ${poNumber}`);cov_20aut6ewqm.s[91]++;logger.error(e);cov_20aut6ewqm.s[92]++;return;}}};cov_20aut6ewqm.s[93]++;__decorate([fabric_contract_api_1.Transaction(),fabric_contract_api_1.Param("newListOfRDCReceivedLists","RDCReceivedList[]"),fabric_contract_api_1.Returns('AssetProcurement[]'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context,Array]),__metadata("design:returntype",Promise)],RDCReceivedContract.prototype,"bulkSaveRDCReceived",null);cov_20aut6ewqm.s[94]++;__decorate([fabric_contract_api_1.Transaction(),fabric_contract_api_1.Param("poNumber","string"),fabric_contract_api_1.Param("newRDCReceivedList","RDCReceived[]"),fabric_contract_api_1.Returns('AssetProcurement'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context,String,Array]),__metadata("design:returntype",Promise)],RDCReceivedContract.prototype,"saveRDCReceived",null);cov_20aut6ewqm.s[95]++;RDCReceivedContract=__decorate([fabric_contract_api_1.Info({title:'RDCReceivedContract',description:'Contract for managing the list of RDCReceiveds, and their related discrepancies'}),__metadata("design:paramtypes",[])],RDCReceivedContract);cov_20aut6ewqm.s[96]++;exports.RDCReceivedContract=RDCReceivedContract;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxjb250cmFjdHNcXHJkYy1yZWNlaXZlZC5jb250cmFjdC50cyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxjb250cmFjdHNcXHJkYy1yZWNlaXZlZC5jb250cmFjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLDZEQUEyRjtBQUMzRixzQ0FBOEk7QUFDOUksa0RBQWlIO0FBQ2pILDREQUF3RDtBQUV4RCxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDcEMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO0FBSXZFLElBQWEsbUJBQW1CLEdBQWhDLE1BQWEsbUJBQW9CLFNBQVEsOEJBQVE7SUFHN0MsZ0JBQWdCLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUd6RSw0RkFBNEY7SUFJckYsS0FBSyxDQUFDLG1CQUFtQixDQUFDLEdBQVksRUFBRSx5QkFBNEM7UUFDdkYsSUFBSTtZQUNBLGlDQUFpQztZQUNqQyxJQUFJLHlCQUF5QixDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUM7Z0JBQ3ZDLE1BQU0sSUFBSSxLQUFLLENBQUMsb0RBQW9ELENBQUMsQ0FBQzthQUN6RTtZQUVELHFFQUFxRTtZQUNyRSxJQUFJLEdBQUcsR0FBd0IsRUFBRSxDQUFDO1lBQ2xDLEtBQUssSUFBSSxnQkFBZ0IsSUFBSSx5QkFBeUIsRUFBRTtnQkFDcEQsSUFBSSxjQUFjLEdBQXNCLE1BQU0sSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLEVBQUUsZ0JBQWdCLENBQUMsUUFBUSxF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LEVBQUUsaUZBQWlGLEVBQUUsQ0FBQzs7R0FDMUgsbUJBQW1CLENBc0kvQjtBQXRJWSxrREFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZXh0LCBDb250cmFjdCwgSW5mbywgUmV0dXJucywgVHJhbnNhY3Rpb24sIFBhcmFtIH0gZnJvbSAnZmFicmljLWNvbnRyYWN0LWFwaSc7XHJcbmltcG9ydCB7IFJEQ1JlY2VpdmVkLCBBc3NldFByb2N1cmVtZW50LCBTdGFnZVR5cGUsIFVuaXRPZk1lYXN1cmUsIFVuaXRPZk1lYXN1cmVMaXN0LCBBRFJSdWxlLCBBRFJSdWxlTGlzdCwgUkRDUmVjZWl2ZWRMaXN0IH0gZnJvbSBcIi4uL21vZGVsc1wiO1xyXG5pbXBvcnQgeyBBc3NldFByb2N1cmVtZW50UmVwb3NpdG9yeSwgVW5pdE9mTWVhc3VyZUxpc3RSZXBvc2l0b3J5LCBBRFJSdWxlTGlzdFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMnO1xyXG5pbXBvcnQgeyBQcm9jZXNzaW5nRW5naW5lIH0gZnJvbSAnLi4vcHJvY2Vzc2luZy1lbmdpbmUnO1xyXG5cclxuY29uc3QgTG9nZ2VyID0gcmVxdWlyZSgnLi4vbG9nZ2VyJyk7XHJcbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRMb2dnZXIoJy4vY29udHJhY3RzL2lmYy1zaGlwcGVkLmNvbnRyYWN0LnRzJyk7XHJcblxyXG5cclxuQEluZm8oeyB0aXRsZTogJ1JEQ1JlY2VpdmVkQ29udHJhY3QnLCBkZXNjcmlwdGlvbjogJ0NvbnRyYWN0IGZvciBtYW5hZ2luZyB0aGUgbGlzdCBvZiBSRENSZWNlaXZlZHMsIGFuZCB0aGVpciByZWxhdGVkIGRpc2NyZXBhbmNpZXMnIH0pXHJcbmV4cG9ydCBjbGFzcyBSRENSZWNlaXZlZENvbnRyYWN0IGV4dGVuZHMgQ29udHJhY3Qge1xyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgc3VwZXIoXCJjb20uaG9tZWRlcG90LnByb2N1cmVtZW50LlJEQ1JlY2VpdmVkQ29udHJhY3RcIik7IH1cclxuXHJcblxyXG4gICAgLy8gVXNlZCB0byBidWxrIG1lcmdlIHNldmVyYWwgcmVjb3JkcyBvZiBuZXcgUkRDUmVjZWl2ZWQgZGF0YSB3aXRoIGV4aXN0aW5nIFJEQ1JlY2VpdmVkIGRhdGFcclxuICAgIEBUcmFuc2FjdGlvbigpXHJcbiAgICBAUGFyYW0oXCJuZXdMaXN0T2ZSRENSZWNlaXZlZExpc3RzXCIsIFwiUkRDUmVjZWl2ZWRMaXN0W11cIilcclxuICAgIEBSZXR1cm5zKCdBc3NldFByb2N1cmVtZW50W10nKSAgICBcclxuICAgIHB1YmxpYyBhc3luYyBidWxrU2F2ZVJEQ1JlY2VpdmVkKGN0eDogQ29udGV4dCwgbmV3TGlzdE9mUkRDUmVjZWl2ZWRMaXN0czogUkRDUmVjZWl2ZWRMaXN0W10pOiBQcm9taXNlPEFzc2V0UHJvY3VyZW1lbnRbXT4geyAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gU2FuaXR5LWNoZWNrczogbGlzdC5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgIGlmIChuZXdMaXN0T2ZSRENSZWNlaXZlZExpc3RzLmxlbmd0aCA9PT0gMCl7IFxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBidWxrU2F2ZVJEQ1JlY2VpdmVkIHdhcyBjYWxsZWQgd2l0aCAwIFJEQ1JlY2VpdmVkc2ApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgZWFjaCBzZXQgb2YgUE8gaXRlbXMgdG8gdGhlIGJsb2NrY2hhaW4sIG9uZSBQT051bWJlciBhdCBhIHRpbWVcclxuICAgICAgICAgICAgbGV0IGFwcyA6IEFzc2V0UHJvY3VyZW1lbnRbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjdXJyZW50SXRlbXNMaXN0IG9mIG5ld0xpc3RPZlJEQ1JlY2VpdmVkTGlzdHMpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50U2F2ZWRBUCA6IEFzc2V0UHJvY3VyZW1lbnQgPSBhd2FpdCB0aGlzLnNhdmVSRENSZWNlaXZlZChjdHgsIGN1cnJlbnRJdGVtc0xpc3QuUE9OdW1iZXIsIGN1cnJlbnRJdGVtc0xpc3QuSXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgYXBzLnB1c2goY3VycmVudFNhdmVkQVApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gYXBzO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGBidWxrU2F2ZVJEQ1JlY2VpdmVkIGZhaWxlZGApO1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8vIFVzZWQgdG8gbWVyZ2UgbmV3IFJEQ1JlY2VpdmVkIGRhdGEgd2l0aCBleGlzdGluZyBSRENSZWNlaXZlZCBkYXRhXHJcbiAgICBAVHJhbnNhY3Rpb24oKVxyXG4gICAgQFBhcmFtKFwicG9OdW1iZXJcIiwgXCJzdHJpbmdcIilcclxuICAgIEBQYXJhbShcIm5ld1JEQ1JlY2VpdmVkTGlzdFwiLCBcIlJEQ1JlY2VpdmVkW11cIilcclxuICAgIEBSZXR1cm5zKCdBc3NldFByb2N1cmVtZW50JykgICAgXHJcbiAgICBwdWJsaWMgYXN5bmMgc2F2ZVJEQ1JlY2VpdmVkKGN0eDogQ29udGV4dCwgcG9OdW1iZXI6IHN0cmluZywgbmV3UkRDUmVjZWl2ZWRMaXN0OiBSRENSZWNlaXZlZFtdKTogUHJvbWlzZTxBc3NldFByb2N1cmVtZW50PiB7ICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBTYW5pdHktY2hlY2tzOiBycmxpc3QubGVuZ3RoID4gMCwgYWxsIGl0ZW1zIGluIHJybGlzdCBoYXZlIFBPTnVtYmVyPXBvTnVtYmVyXHJcbiAgICAgICAgICAgIHBvTnVtYmVyID0gcG9OdW1iZXIudHJpbSgpO1xyXG4gICAgICAgICAgICBpZiAobmV3UkRDUmVjZWl2ZWRMaXN0Lmxlbmd0aCA9PT0gMCl7IFxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBzYXZlUkRDUmVjZWl2ZWQgd2FzIGNhbGxlZCB3aXRoIDAgUkRDUmVjZWl2ZWQgaXRlbXMsIGZvciBQT051bWJlciAnJHtwb051bWJlcn0nYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG5ld1JEQ1JlY2VpdmVkTGlzdC5zb21lKCh2LGksbCk9PnsgcmV0dXJuICh2LlBPTnVtYmVyICE9IHBvTnVtYmVyKTsgfSkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgc2F2ZVJEQ1JlY2VpdmVkIHdhcyBjYWxsZWQgd2l0aCBzb21lIFJEQ1JlY2VpdmVkIGl0ZW1zIHRoYXQgZG8gbm90IGhhdmUgUE9OVW1iZXIgJyR7cG9OdW1iZXJ9YCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBhcFJlcG8gOiBBc3NldFByb2N1cmVtZW50UmVwb3NpdG9yeSA9IG5ldyBBc3NldFByb2N1cmVtZW50UmVwb3NpdG9yeShjdHgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUmV0cmlldmUgb3IgY3JlYXRlIHRoZSBBc3NldFByb2N1cmVtZW50IHJlY29yZFxyXG4gICAgICAgICAgICBsZXQgYXAgOiBBc3NldFByb2N1cmVtZW50ID0gbmV3IEFzc2V0UHJvY3VyZW1lbnQoeyBQT051bWJlcjogcG9OdW1iZXIgfSk7XHJcbiAgICAgICAgICAgIGxldCBhcElzTmV3IDogYm9vbGVhbiA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChhd2FpdCBhcFJlcG8uZXhpc3RzKHBvTnVtYmVyKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoYFBPTnVtYmVyICR7cG9OdW1iZXJ9IGV4aXN0c2ApO1xyXG4gICAgICAgICAgICAgICAgYXAgPSBhd2FpdCBhcFJlcG8uZ2V0KHBvTnVtYmVyKTtcclxuICAgICAgICAgICAgICAgIGFwSXNOZXcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnUmV0cmVpdmVkIEFQIGZyb20gc3RvcmFnZScpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGxpc3Qgb2YgVW5pdE9mTWVhc3VyZSBkYXRhXHJcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnUmV0cmlldmluZyBVT00gZGF0YSBmcm9tIHN0b3JhZ2UnKTtcclxuICAgICAgICAgICAgbGV0IHVvbUxpc3QgOiBVbml0T2ZNZWFzdXJlTGlzdCB8IHVuZGVmaW5lZCA9IGF3YWl0IChuZXcgVW5pdE9mTWVhc3VyZUxpc3RSZXBvc2l0b3J5KGN0eCkpLmdldCgpO1xyXG4gICAgICAgICAgICBpZiAodW9tTGlzdCA9PT0gdW5kZWZpbmVkKXsgdW9tTGlzdCA9IG5ldyBVbml0T2ZNZWFzdXJlTGlzdCh7IEl0ZW1zOiBbXSB9KTsgfVxyXG4gICAgICAgICAgICBsb2dnZXIuZGVidWcodW9tTGlzdC5JdGVtcy5sZW5ndGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgY3VycmVudCBBRFIgUnVsZSBkYXRhXHJcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnUmV0cmlldmluZyBBRFIgUnVsZXMgZnJvbSBzdG9yYWdlJyk7XHJcbiAgICAgICAgICAgIGxldCBhZHJSdWxlTGlzdCA6IEFEUlJ1bGVMaXN0IHwgdW5kZWZpbmVkID0gYXdhaXQgKG5ldyBBRFJSdWxlTGlzdFJlcG9zaXRvcnkoY3R4KSkuZ2V0KCk7XHJcbiAgICAgICAgICAgIGlmIChhZHJSdWxlTGlzdCA9PT0gdW5kZWZpbmVkKXsgYWRyUnVsZUxpc3QgPSBuZXcgQURSUnVsZUxpc3QoeyBJdGVtczogW10gfSk7IH1cclxuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGFkclJ1bGVMaXN0Lkl0ZW1zLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBNZXJnZSB0aGUgZXhpc3RpbmcgUkRDUmVjZWl2ZWQgZGF0YSB3aXRoIHRoZSBuZXcgZGF0YVxyXG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1dlICcgKyAoKGFwLlJEQ1JlY2VpdmVkcyAhPT0gdW5kZWZpbmVkICYmIGFwLlJEQ1JlY2VpdmVkcy5sZW5ndGggPiAwKSA/ICdoYXZlJyA6ICdkbyBub3QgaGF2ZScpICsgJyBSUiBkYXRhIGZvciB0aGUgQVAnKTtcclxuICAgICAgICAgICAgaWYgKGFwLlJEQ1JlY2VpdmVkcyAhPT0gdW5kZWZpbmVkICYmIGFwLlJEQ1JlY2VpdmVkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNZXJnZSBhbnkgcmVjb3JkcyB0aGF0IG1hdGNoIG9uIGtleSBpZGVudGlmaWVyIGZpZWxkc1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGBTdGFydGluZyB3aXRoICR7bmV3UkRDUmVjZWl2ZWRMaXN0Lmxlbmd0aH0gbmV3IFJEQ1JlY2VpdmVkc2ApO1xyXG4gICAgICAgICAgICAgICAgbmV3UkRDUmVjZWl2ZWRMaXN0LmZvckVhY2goKHZjLGljLGxjKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBleGlzdGluZ1JlY29yZEluZGV4ID0gYXAuUkRDUmVjZWl2ZWRzIS5maW5kSW5kZXgoKGlubmVyVkMsaW5uZXJJQyxpbm5lckxDKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmMuUkRDPT1pbm5lclZDLlJEQyAmJiB2Yy5TS1UgPT0gaW5uZXJWQy5TS1UgJiYgdmMuUE9OdW1iZXIgPT0gaW5uZXJWQy5QT051bWJlciAmJiB2Yy5LZXlSZWNOdW1iZXIgPT0gaW5uZXJWQy5LZXlSZWNOdW1iZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nUmVjb3JkSW5kZXggPiAtMSkgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdGb3VuZCBhIG5ldyBSUiB0aGF0IG1hdGNoZWQgYW4gZXhpc3Rpbmcgb25lJyk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcC5SRENSZWNlaXZlZHMhW2V4aXN0aW5nUmVjb3JkSW5kZXhdID0gdmM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gRGV0ZXJpbWluZSBhbGwgcmVjb3JkcyB0aGF0IGFyZSBuZXcgYW5kIGRvIG5vdCBtYXRjaCBhbnkgZXhpc3RpbmcgcmVjb3Jkc1xyXG4gICAgICAgICAgICAgICAgbGV0IHVuaXF1ZVJScyA6IFJEQ1JlY2VpdmVkW10gPSBuZXdSRENSZWNlaXZlZExpc3QucmVkdWNlKChwYWM6UkRDUmVjZWl2ZWRbXSx2YyxpYyxsYyk9PntcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZXhpc3RpbmdSZWNvcmRJbmRleCA9IGFwLlJEQ1JlY2VpdmVkcyEuZmluZEluZGV4KChpbm5lclZDLGlubmVySUMsaW5uZXJMQyk9PntcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZjLlJEQz09aW5uZXJWQy5SREMgJiYgdmMuU0tVID09IGlubmVyVkMuU0tVICYmIHZjLlBPTnVtYmVyID09IGlubmVyVkMuUE9OdW1iZXIgJiYgdmMuS2V5UmVjTnVtYmVyID09IGlubmVyVkMuS2V5UmVjTnVtYmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1JlY29yZEluZGV4ID09IC0xKSB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZvdW5kIGEgbmV3IFJSIHRoYXQgZG9lcyBub3QgbWF0Y2ggdGhlIGV4aXN0aW5nIG9uZXMnKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhYy5wdXNoKHZjKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYWM7XHJcbiAgICAgICAgICAgICAgICB9LCBbXSk7XHJcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoYEVuZGVkIHVwIHdpdGggJHt1bmlxdWVSUnMubGVuZ3RofSB0b3RhbGx5IG5ldyBSRENSZWNlaXZlZHNgKTtcclxuICBcclxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGZvdW5kIHNvbWUgbmV3IHJlY29yZHMgdG8gYWRkLCBBcHBlbmQgbmV3IHJlY29yZHMgdG8gdGhlIGV4aXN0aW5nIG9uZXNcclxuICAgICAgICAgICAgICAgIGlmICh1bmlxdWVSUnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnQWRkaW5nIHRoZSBmaW5hbCBsaXN0IG9mIHVuaXF1ZSBSUnMgdG8gdGhlIGV4aXN0aW5nIGxpc3Qgb2YgUlJzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXAuUkRDUmVjZWl2ZWRzLnB1c2goLi4udW5pcXVlUlJzKTtcclxuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdBZGRpbmcgYWxsIG5ldyBSUnMgc2luY2UgdGhlcmUgYXJlIG5vIGV4aXN0aW5nIFJScy4nKTtcclxuICAgICAgICAgICAgICAgIGFwLnNldFN0YWdlRGV0YWlscyhTdGFnZVR5cGUuUkRDUmVjZWl2ZWQsIG5ld1JEQ1JlY2VpdmVkTGlzdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJ1biB0aGlzIHRocm91Z2ggdGhlIHByb2Nlc3NpbmcgZW5naW5lIChGU00pXHJcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnU3RhcnRpbmcgdGhlIHByb2Nlc3NpbmcgZW5naW5lJyk7XHJcbiAgICAgICAgICAgIGxldCB1cGRhdGVkQVAgOiBBc3NldFByb2N1cmVtZW50ID0gUHJvY2Vzc2luZ0VuZ2luZS5zdGFydFByb2Nlc3NpbmcoYXAsIHsgdW9tTGlzdCwgYWRyUnVsZUxpc3QgfSk7XHJcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnRmluaXNoZWQgdGhlIHByb2Nlc3NpbmcgZW5naW5lJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTYXZlIHRoZSBBc3NldFByb2N1cmVtZW50IHJlY29yZFxyXG4gICAgICAgICAgICBpZiAoYXBJc05ldykge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdBdHRlbXB0aW5nIHRvIGNyZWF0ZSBhIG5ldyBBUCcpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgYXBSZXBvLmNyZWF0ZSh1cGRhdGVkQVApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdBdHRlbXB0aW5nIHRvIHVwZGF0ZSBhbiBleGlzdGluZyBBUCcpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgYXBSZXBvLnVwZGF0ZSh1cGRhdGVkQVApO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoYHNhdmVSRENSZWNlaXZlZCBzYXZlZCAke25ld1JEQ1JlY2VpdmVkTGlzdC5sZW5ndGh9IFJEQ1JlY2VpdmVkIGl0ZW1zIGZvciBQT051bWJlciAke3BvTnVtYmVyfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZEFQO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGBzYXZlUkRDUmVjZWl2ZWQgZmFpbGVkIGZvciBQT051bWJlciAke3BvTnVtYmVyfWApO1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59Il19