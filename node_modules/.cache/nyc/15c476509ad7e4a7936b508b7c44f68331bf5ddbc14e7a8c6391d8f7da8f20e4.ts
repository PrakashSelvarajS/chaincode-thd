"use strict";var cov_1xhcbbo7gj=function(){var path="C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\vendor.contract.ts";var hash="5c33999f26edc55033fa8026d8be0e01f5c29df1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\vendor.contract.ts",statementMap:{"0":{start:{line:2,column:17},end:{line:7,column:1}},"1":{start:{line:3,column:12},end:{line:3,column:28}},"2":{start:{line:3,column:34},end:{line:3,column:125}},"3":{start:{line:4,column:4},end:{line:5,column:150}},"4":{start:{line:4,column:79},end:{line:4,column:131}},"5":{start:{line:5,column:9},end:{line:5,column:150}},"6":{start:{line:5,column:22},end:{line:5,column:43}},"7":{start:{line:5,column:58},end:{line:5,column:150}},"8":{start:{line:5,column:81},end:{line:5,column:150}},"9":{start:{line:6,column:4},end:{line:6,column:66}},"10":{start:{line:8,column:17},end:{line:10,column:1}},"11":{start:{line:9,column:4},end:{line:9,column:109}},"12":{start:{line:9,column:79},end:{line:9,column:109}},"13":{start:{line:11,column:0},end:{line:11,column:62}},"14":{start:{line:12,column:30},end:{line:12,column:60}},"15":{start:{line:13,column:17},end:{line:13,column:37}},"16":{start:{line:14,column:23},end:{line:14,column:49}},"17":{start:{line:15,column:21},end:{line:75,column:1}},"18":{start:{line:16,column:20},end:{line:16,column:70}},"19":{start:{line:20,column:8},end:{line:23,column:11}},"20":{start:{line:21,column:12},end:{line:21,column:56}},"21":{start:{line:22,column:12},end:{line:22,column:21}},"22":{start:{line:24,column:21},end:{line:24,column:65}},"23":{start:{line:26,column:35},end:{line:26,column:51}},"24":{start:{line:27,column:27},end:{line:27,column:29}},"25":{start:{line:29,column:8},end:{line:58,column:9}},"26":{start:{line:30,column:12},end:{line:30,column:93}},"27":{start:{line:31,column:32},end:{line:31,column:78}},"28":{start:{line:32,column:12},end:{line:32,column:45}},"29":{start:{line:33,column:12},end:{line:33,column:47}},"30":{start:{line:37,column:12},end:{line:45,column:13}},"31":{start:{line:38,column:42},end:{line:38,column:146}},"32":{start:{line:38,column:95},end:{line:38,column:143}},"33":{start:{line:39,column:16},end:{line:44,column:17}},"34":{start:{line:41,column:20},end:{line:41,column:101}},"35":{start:{line:42,column:20},end:{line:42,column:83}},"36":{start:{line:43,column:20},end:{line:43,column:56}},"37":{start:{line:47,column:45},end:{line:47,column:186}},"38":{start:{line:47,column:78},end:{line:47,column:183}},"39":{start:{line:47,column:139},end:{line:47,column:172}},"40":{start:{line:48,column:12},end:{line:51,column:13}},"41":{start:{line:49,column:16},end:{line:49,column:77}},"42":{start:{line:50,column:16},end:{line:50,column:65}},"43":{start:{line:53,column:12},end:{line:56,column:15}},"44":{start:{line:54,column:16},end:{line:54,column:60}},"45":{start:{line:55,column:16},end:{line:55,column:25}},"46":{start:{line:57,column:12},end:{line:57,column:50}},"47":{start:{line:59,column:8},end:{line:59,column:28}},"48":{start:{line:63,column:8},end:{line:63,column:72}},"49":{start:{line:66,column:19},end:{line:66,column:63}},"50":{start:{line:67,column:27},end:{line:67,column:43}},"51":{start:{line:68,column:8},end:{line:73,column:9}},"52":{start:{line:69,column:12},end:{line:69,column:89}},"53":{start:{line:72,column:12},end:{line:72,column:36}},"54":{start:{line:76,column:0},end:{line:83,column:49}},"55":{start:{line:84,column:0},end:{line:90,column:53}},"56":{start:{line:91,column:0},end:{line:94,column:19}},"57":{start:{line:95,column:0},end:{line:95,column:40}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:46},end:{line:2,column:47}},loc:{start:{line:2,column:87},end:{line:7,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:46},end:{line:8,column:47}},loc:{start:{line:8,column:62},end:{line:10,column:1}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:16,column:4},end:{line:16,column:5}},loc:{start:{line:16,column:18},end:{line:16,column:72}},line:16},"3":{name:"(anonymous_3)",decl:{start:{line:18,column:4},end:{line:18,column:5}},loc:{start:{line:18,column:38},end:{line:60,column:5}},line:18},"4":{name:"(anonymous_4)",decl:{start:{line:20,column:36},end:{line:20,column:37}},loc:{start:{line:20,column:49},end:{line:23,column:9}},line:20},"5":{name:"(anonymous_5)",decl:{start:{line:38,column:77},end:{line:38,column:78}},loc:{start:{line:38,column:93},end:{line:38,column:145}},line:38},"6":{name:"(anonymous_6)",decl:{start:{line:47,column:63},end:{line:47,column:64}},loc:{start:{line:47,column:76},end:{line:47,column:185}},line:47},"7":{name:"(anonymous_7)",decl:{start:{line:47,column:121},end:{line:47,column:122}},loc:{start:{line:47,column:137},end:{line:47,column:174}},line:47},"8":{name:"(anonymous_8)",decl:{start:{line:53,column:68},end:{line:53,column:69}},loc:{start:{line:53,column:81},end:{line:56,column:13}},line:53},"9":{name:"(anonymous_9)",decl:{start:{line:62,column:4},end:{line:62,column:5}},loc:{start:{line:62,column:33},end:{line:64,column:5}},line:62},"10":{name:"(anonymous_10)",decl:{start:{line:65,column:4},end:{line:65,column:5}},loc:{start:{line:65,column:30},end:{line:74,column:5}},line:65}},branchMap:{"0":{loc:{start:{line:2,column:17},end:{line:7,column:1}},type:"binary-expr",locations:[{start:{line:2,column:18},end:{line:2,column:22}},{start:{line:2,column:26},end:{line:2,column:41}},{start:{line:2,column:46},end:{line:7,column:1}}],line:2},"1":{loc:{start:{line:3,column:34},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:42},end:{line:3,column:48}},{start:{line:3,column:51},end:{line:3,column:125}}],line:3},"2":{loc:{start:{line:3,column:51},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:67},end:{line:3,column:118}},{start:{line:3,column:121},end:{line:3,column:125}}],line:3},"3":{loc:{start:{line:4,column:4},end:{line:5,column:150}},type:"if",locations:[{start:{line:4,column:4},end:{line:5,column:150}},{start:{line:4,column:4},end:{line:5,column:150}}],line:4},"4":{loc:{start:{line:4,column:8},end:{line:4,column:77}},type:"binary-expr",locations:[{start:{line:4,column:8},end:{line:4,column:35}},{start:{line:4,column:39},end:{line:4,column:77}}],line:4},"5":{loc:{start:{line:5,column:58},end:{line:5,column:150}},type:"if",locations:[{start:{line:5,column:58},end:{line:5,column:150}},{start:{line:5,column:58},end:{line:5,column:150}}],line:5},"6":{loc:{start:{line:5,column:85},end:{line:5,column:149}},type:"binary-expr",locations:[{start:{line:5,column:86},end:{line:5,column:143}},{start:{line:5,column:148},end:{line:5,column:149}}],line:5},"7":{loc:{start:{line:5,column:86},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:94},end:{line:5,column:98}},{start:{line:5,column:101},end:{line:5,column:143}}],line:5},"8":{loc:{start:{line:5,column:101},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:109},end:{line:5,column:126}},{start:{line:5,column:129},end:{line:5,column:143}}],line:5},"9":{loc:{start:{line:6,column:11},end:{line:6,column:62}},type:"binary-expr",locations:[{start:{line:6,column:11},end:{line:6,column:16}},{start:{line:6,column:20},end:{line:6,column:21}},{start:{line:6,column:25},end:{line:6,column:62}}],line:6},"10":{loc:{start:{line:8,column:17},end:{line:10,column:1}},type:"binary-expr",locations:[{start:{line:8,column:18},end:{line:8,column:22}},{start:{line:8,column:26},end:{line:8,column:41}},{start:{line:8,column:46},end:{line:10,column:1}}],line:8},"11":{loc:{start:{line:9,column:4},end:{line:9,column:109}},type:"if",locations:[{start:{line:9,column:4},end:{line:9,column:109}},{start:{line:9,column:4},end:{line:9,column:109}}],line:9},"12":{loc:{start:{line:9,column:8},end:{line:9,column:77}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:35}},{start:{line:9,column:39},end:{line:9,column:77}}],line:9},"13":{loc:{start:{line:29,column:8},end:{line:58,column:9}},type:"if",locations:[{start:{line:29,column:8},end:{line:58,column:9}},{start:{line:29,column:8},end:{line:58,column:9}}],line:29},"14":{loc:{start:{line:29,column:12},end:{line:29,column:127}},type:"binary-expr",locations:[{start:{line:29,column:12},end:{line:29,column:44}},{start:{line:29,column:48},end:{line:29,column:86}},{start:{line:29,column:90},end:{line:29,column:127}}],line:29},"15":{loc:{start:{line:39,column:16},end:{line:44,column:17}},type:"if",locations:[{start:{line:39,column:16},end:{line:44,column:17}},{start:{line:39,column:16},end:{line:44,column:17}}],line:39},"16":{loc:{start:{line:48,column:12},end:{line:51,column:13}},type:"if",locations:[{start:{line:48,column:12},end:{line:51,column:13}},{start:{line:48,column:12},end:{line:51,column:13}}],line:48},"17":{loc:{start:{line:68,column:8},end:{line:73,column:9}},type:"if",locations:[{start:{line:68,column:8},end:{line:73,column:9}},{start:{line:68,column:8},end:{line:73,column:9}}],line:68},"18":{loc:{start:{line:68,column:12},end:{line:68,column:102}},type:"binary-expr",locations:[{start:{line:68,column:12},end:{line:68,column:36}},{start:{line:68,column:40},end:{line:68,column:70}},{start:{line:68,column:74},end:{line:68,column:102}}],line:68}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"5c33999f26edc55033fa8026d8be0e01f5c29df1"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var __decorate=(cov_1xhcbbo7gj.s[0]++,(cov_1xhcbbo7gj.b[0][0]++,this)&&(cov_1xhcbbo7gj.b[0][1]++,this.__decorate)||(cov_1xhcbbo7gj.b[0][2]++,function(decorators,target,key,desc){cov_1xhcbbo7gj.f[0]++;var c=(cov_1xhcbbo7gj.s[1]++,arguments.length),r=(cov_1xhcbbo7gj.s[2]++,c<3?(cov_1xhcbbo7gj.b[1][0]++,target):(cov_1xhcbbo7gj.b[1][1]++,desc===null?(cov_1xhcbbo7gj.b[2][0]++,desc=Object.getOwnPropertyDescriptor(target,key)):(cov_1xhcbbo7gj.b[2][1]++,desc))),d;cov_1xhcbbo7gj.s[3]++;if((cov_1xhcbbo7gj.b[4][0]++,typeof Reflect==="object")&&(cov_1xhcbbo7gj.b[4][1]++,typeof Reflect.decorate==="function")){cov_1xhcbbo7gj.b[3][0]++;cov_1xhcbbo7gj.s[4]++;r=Reflect.decorate(decorators,target,key,desc);}else{cov_1xhcbbo7gj.b[3][1]++;cov_1xhcbbo7gj.s[5]++;for(var i=(cov_1xhcbbo7gj.s[6]++,decorators.length-1);i>=0;i--){cov_1xhcbbo7gj.s[7]++;if(d=decorators[i]){cov_1xhcbbo7gj.b[5][0]++;cov_1xhcbbo7gj.s[8]++;r=(cov_1xhcbbo7gj.b[6][0]++,c<3?(cov_1xhcbbo7gj.b[7][0]++,d(r)):(cov_1xhcbbo7gj.b[7][1]++,c>3?(cov_1xhcbbo7gj.b[8][0]++,d(target,key,r)):(cov_1xhcbbo7gj.b[8][1]++,d(target,key))))||(cov_1xhcbbo7gj.b[6][1]++,r);}else{cov_1xhcbbo7gj.b[5][1]++;}}}cov_1xhcbbo7gj.s[9]++;return(cov_1xhcbbo7gj.b[9][0]++,c>3)&&(cov_1xhcbbo7gj.b[9][1]++,r)&&(cov_1xhcbbo7gj.b[9][2]++,Object.defineProperty(target,key,r)),r;}));var __metadata=(cov_1xhcbbo7gj.s[10]++,(cov_1xhcbbo7gj.b[10][0]++,this)&&(cov_1xhcbbo7gj.b[10][1]++,this.__metadata)||(cov_1xhcbbo7gj.b[10][2]++,function(k,v){cov_1xhcbbo7gj.f[1]++;cov_1xhcbbo7gj.s[11]++;if((cov_1xhcbbo7gj.b[12][0]++,typeof Reflect==="object")&&(cov_1xhcbbo7gj.b[12][1]++,typeof Reflect.metadata==="function")){cov_1xhcbbo7gj.b[11][0]++;cov_1xhcbbo7gj.s[12]++;return Reflect.metadata(k,v);}else{cov_1xhcbbo7gj.b[11][1]++;}}));cov_1xhcbbo7gj.s[13]++;Object.defineProperty(exports,"__esModule",{value:true});const fabric_contract_api_1=(cov_1xhcbbo7gj.s[14]++,require("fabric-contract-api"));const models_1=(cov_1xhcbbo7gj.s[15]++,require("../models"));const repositories_1=(cov_1xhcbbo7gj.s[16]++,require("../repositories"));cov_1xhcbbo7gj.s[17]++;let VendorContract=class VendorContract extends fabric_contract_api_1.Contract{constructor(){cov_1xhcbbo7gj.f[2]++;cov_1xhcbbo7gj.s[18]++;super("com.homedepot.procurement.VendorContract");}// Used to merge new Vendor data with existing Vendor data
async saveVendor(ctx,newVendors){cov_1xhcbbo7gj.f[3]++;cov_1xhcbbo7gj.s[19]++;// Clean up the Vendor names to remove double quotes and trailing/leading spaces
newVendors=newVendors.map((v,i,l)=>{cov_1xhcbbo7gj.f[4]++;cov_1xhcbbo7gj.s[20]++;v.Name=v.Name.replace(/["]+/g,'').trim();cov_1xhcbbo7gj.s[21]++;return v;});const repo=(cov_1xhcbbo7gj.s[22]++,new repositories_1.VendorListRepository(ctx));// Get the list of existing Vendor items
const existingVendorList=(cov_1xhcbbo7gj.s[23]++,await repo.get());let savedVendors=(cov_1xhcbbo7gj.s[24]++,[]);// If there are no existing Vendor items, then store the new Vendor list
cov_1xhcbbo7gj.s[25]++;if((cov_1xhcbbo7gj.b[14][0]++,existingVendorList===undefined)||(cov_1xhcbbo7gj.b[14][1]++,existingVendorList.Items===undefined)||(cov_1xhcbbo7gj.b[14][2]++,existingVendorList.Items.length===0)){cov_1xhcbbo7gj.b[13][0]++;cov_1xhcbbo7gj.s[26]++;console.log('No Vendor data, adding all the provided Vendor data to the ledger');let newVendorList=(cov_1xhcbbo7gj.s[27]++,new models_1.VendorList({Items:newVendors}));cov_1xhcbbo7gj.s[28]++;await repo.create(newVendorList);cov_1xhcbbo7gj.s[29]++;savedVendors=newVendorList.Items;}else{cov_1xhcbbo7gj.b[13][1]++;cov_1xhcbbo7gj.s[30]++;// Merge the existing Vendor with the new Vendor, using SKU as a unique identifier
for(let currentNewVendor of newVendors){const existingItemIndex=(cov_1xhcbbo7gj.s[31]++,existingVendorList.Items.findIndex((vv,ii,ll)=>{cov_1xhcbbo7gj.f[5]++;cov_1xhcbbo7gj.s[32]++;return currentNewVendor.VendorID==vv.VendorID;}));cov_1xhcbbo7gj.s[33]++;if(existingItemIndex>-1){cov_1xhcbbo7gj.b[15][0]++;cov_1xhcbbo7gj.s[34]++;// Overwrite the existing item values with the new values                    
currentNewVendor.RecordID=existingVendorList.Items[existingItemIndex].RecordID;cov_1xhcbbo7gj.s[35]++;existingVendorList.Items[existingItemIndex]=currentNewVendor;cov_1xhcbbo7gj.s[36]++;savedVendors.push(currentNewVendor);}else{cov_1xhcbbo7gj.b[15][1]++;}}// Get a list of records that are in the new list, but not in the existing list
let newVendorNotInExistingList=(cov_1xhcbbo7gj.s[37]++,newVendors.filter((v,i,l)=>{cov_1xhcbbo7gj.f[6]++;cov_1xhcbbo7gj.s[38]++;return existingVendorList.Items.findIndex((vv,ii,ll)=>{cov_1xhcbbo7gj.f[7]++;cov_1xhcbbo7gj.s[39]++;return v.VendorID==vv.VendorID;})==-1;}));cov_1xhcbbo7gj.s[40]++;if(newVendorNotInExistingList.length>0){cov_1xhcbbo7gj.b[16][0]++;cov_1xhcbbo7gj.s[41]++;existingVendorList.Items.push(...newVendorNotInExistingList);cov_1xhcbbo7gj.s[42]++;savedVendors.push(...newVendorNotInExistingList);}else{cov_1xhcbbo7gj.b[16][1]++;}// HACK : This is a temporary fix to remove double-quotes from all Vendor names....this should be removed after all entries have been fixed in the blockchain
cov_1xhcbbo7gj.s[43]++;existingVendorList.Items=existingVendorList.Items.map((v,i,l)=>{cov_1xhcbbo7gj.f[8]++;cov_1xhcbbo7gj.s[44]++;v.Name=v.Name.replace(/["]+/g,'').trim();cov_1xhcbbo7gj.s[45]++;return v;});cov_1xhcbbo7gj.s[46]++;await repo.update(existingVendorList);}cov_1xhcbbo7gj.s[47]++;return savedVendors;}// Delete an existing Vendor record by its SKU
async deleteVendor(ctx,sku){cov_1xhcbbo7gj.f[9]++;cov_1xhcbbo7gj.s[48]++;throw new Error('ERROR: deleteVendor has not been implemented');}async retrieveVendor(ctx){cov_1xhcbbo7gj.f[10]++;let repo=(cov_1xhcbbo7gj.s[49]++,new repositories_1.VendorListRepository(ctx));const vendorList=(cov_1xhcbbo7gj.s[50]++,await repo.get());cov_1xhcbbo7gj.s[51]++;if((cov_1xhcbbo7gj.b[18][0]++,vendorList===undefined)||(cov_1xhcbbo7gj.b[18][1]++,vendorList.Items===undefined)||(cov_1xhcbbo7gj.b[18][2]++,vendorList.Items.length==0)){cov_1xhcbbo7gj.b[17][0]++;cov_1xhcbbo7gj.s[52]++;throw new Error(`ERROR: No Vendors exist in the blockchain for this Vendor`);}else{cov_1xhcbbo7gj.b[17][1]++;cov_1xhcbbo7gj.s[53]++;return vendorList.Items;}}};cov_1xhcbbo7gj.s[54]++;__decorate([fabric_contract_api_1.Transaction(true),fabric_contract_api_1.Param("newVendors","Vendor[]"),fabric_contract_api_1.Returns('Vendor[]'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context,Array]),__metadata("design:returntype",Promise)],VendorContract.prototype,"saveVendor",null);cov_1xhcbbo7gj.s[55]++;__decorate([fabric_contract_api_1.Transaction(false),fabric_contract_api_1.Returns('Vendor[]'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context]),__metadata("design:returntype",Promise)],VendorContract.prototype,"retrieveVendor",null);cov_1xhcbbo7gj.s[56]++;VendorContract=__decorate([fabric_contract_api_1.Info({title:'VendorContract',description:'Contract for managing the list of "Vendor" (and sub-vendor) identification data for a Vendor'}),__metadata("design:paramtypes",[])],VendorContract);cov_1xhcbbo7gj.s[57]++;exports.VendorContract=VendorContract;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxjb250cmFjdHNcXHZlbmRvci5jb250cmFjdC50cyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxjb250cmFjdHNcXHZlbmRvci5jb250cmFjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLDZEQUEyRjtBQUMzRixzQ0FBK0M7QUFDL0Msa0RBQXVEO0FBTXZELElBQWEsY0FBYyxHQUEzQixNQUFhLGNBQWUsU0FBUSw4QkFBUTtJQUd4QyxnQkFBZ0IsS0FBSyxDQUFDLDBDQUEwQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRXBFLDBEQUEwRDtJQUluRCxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQVksRUFBRSxVQUFvQjtRQUN0RCxnRkFBZ0Y7UUFDaEYsVUFBVSxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBRSxFQUFFO1lBQ2xDLENBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQzVDLE9BQU8sQ0FBQyxDQUFDO1FBQ2IsQ0FBQyxDQUFDLENBQUM7UUFFSCxNQUFNLElBQUksR0FBMEIsSUFBSSxtQ0FBb0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVsRSx3Q0FBd0M7UUFDeEMsTUFBTSxrQkFBa0IsR0FBZ0IsTUFBTSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDekQsSUFBSSxZQUFZLEdBQWMsRUFBRSxDQUFDO1FBRWpDLHdFQUF3RTtRQUN4RSxJQUFJLGtCQUFrQixLQUFL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VSxLQUFLLFNBQVMsSUFBSSxVQUFVLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7WUFDNUYsTUFBTSxJQUFJLEtBQUssQ0FBQywyREFBMkQsQ0FBQyxDQUFDO1NBQ2hGO2FBQU07WUFDSCxPQUFPLFVBQVUsQ0FBQyxLQUFLLENBQUM7U0FDM0I7SUFDTCxDQUFDO0NBRUosQ0FBQTtBQXRFRztJQUhDLGlDQUFXLENBQUMsSUFBSSxDQUFDO0lBQ2pCLDJCQUFLLENBQUMsWUFBWSxFQUFFLFVBQVUsQ0FBQztJQUMvQiw2QkFBTyxDQUFDLFVBQVUsQ0FBQzs7cUNBQ1MsNkJBQU87O2dEQWlEbkM7QUFXRDtJQUZDLGlDQUFXLENBQUMsS0FBSyxDQUFDO0lBQ2xCLDZCQUFPLENBQUMsVUFBVSxDQUFDOztxQ0FDYSw2QkFBTzs7b0RBUXZDO0FBN0VRLGNBQWM7SUFEMUIsMEJBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxXQUFXLEVBQUUsOEZBQThGLEVBQUUsQ0FBQzs7R0FDbEksY0FBYyxDQStFMUI7QUEvRVksd0NBQWMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZXh0LCBDb250cmFjdCwgSW5mbywgUmV0dXJucywgVHJhbnNhY3Rpb24sIFBhcmFtIH0gZnJvbSAnZmFicmljLWNvbnRyYWN0LWFwaSc7XHJcbmltcG9ydCB7IFZlbmRvciwgVmVuZG9yTGlzdCB9IGZyb20gXCIuLi9tb2RlbHNcIjtcclxuaW1wb3J0IHsgVmVuZG9yTGlzdFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMnO1xyXG5cclxuXHJcblxyXG5cclxuQEluZm8oeyB0aXRsZTogJ1ZlbmRvckNvbnRyYWN0JywgZGVzY3JpcHRpb246ICdDb250cmFjdCBmb3IgbWFuYWdpbmcgdGhlIGxpc3Qgb2YgXCJWZW5kb3JcIiAoYW5kIHN1Yi12ZW5kb3IpIGlkZW50aWZpY2F0aW9uIGRhdGEgZm9yIGEgVmVuZG9yJyB9KVxyXG5leHBvcnQgY2xhc3MgVmVuZG9yQ29udHJhY3QgZXh0ZW5kcyBDb250cmFjdCB7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyBzdXBlcihcImNvbS5ob21lZGVwb3QucHJvY3VyZW1lbnQuVmVuZG9yQ29udHJhY3RcIik7IH1cclxuXHJcbiAgICAvLyBVc2VkIHRvIG1lcmdlIG5ldyBWZW5kb3IgZGF0YSB3aXRoIGV4aXN0aW5nIFZlbmRvciBkYXRhXHJcbiAgICBAVHJhbnNhY3Rpb24odHJ1ZSlcclxuICAgIEBQYXJhbShcIm5ld1ZlbmRvcnNcIiwgXCJWZW5kb3JbXVwiKVxyXG4gICAgQFJldHVybnMoJ1ZlbmRvcltdJylcclxuICAgIHB1YmxpYyBhc3luYyBzYXZlVmVuZG9yKGN0eDogQ29udGV4dCwgbmV3VmVuZG9yczogVmVuZG9yW10pOiBQcm9taXNlPFZlbmRvcltdPiB7XHJcbiAgICAgICAgLy8gQ2xlYW4gdXAgdGhlIFZlbmRvciBuYW1lcyB0byByZW1vdmUgZG91YmxlIHF1b3RlcyBhbmQgdHJhaWxpbmcvbGVhZGluZyBzcGFjZXNcclxuICAgICAgICBuZXdWZW5kb3JzID0gbmV3VmVuZG9ycy5tYXAoKHYsaSxsKSA9PiB7XHJcbiAgICAgICAgICAgIHYuTmFtZSA9IHYuTmFtZS5yZXBsYWNlKC9bXCJdKy9nLCAnJykudHJpbSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdjsgXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcG8gOiBWZW5kb3JMaXN0UmVwb3NpdG9yeSA9IG5ldyBWZW5kb3JMaXN0UmVwb3NpdG9yeShjdHgpO1xyXG5cclxuICAgICAgICAvLyBHZXQgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgVmVuZG9yIGl0ZW1zXHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdWZW5kb3JMaXN0IDogVmVuZG9yTGlzdCA9IGF3YWl0IHJlcG8uZ2V0KCk7XHJcbiAgICAgICAgbGV0IHNhdmVkVmVuZG9ycyA6IFZlbmRvcltdID0gW107XHJcblxyXG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBleGlzdGluZyBWZW5kb3IgaXRlbXMsIHRoZW4gc3RvcmUgdGhlIG5ldyBWZW5kb3IgbGlzdFxyXG4gICAgICAgIGlmIChleGlzdGluZ1ZlbmRvckxpc3QgPT09IHVuZGVmaW5lZCB8fCBleGlzdGluZ1ZlbmRvckxpc3QuSXRlbXMgPT09IHVuZGVmaW5lZCB8fCBleGlzdGluZ1ZlbmRvckxpc3QuSXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBWZW5kb3IgZGF0YSwgYWRkaW5nIGFsbCB0aGUgcHJvdmlkZWQgVmVuZG9yIGRhdGEgdG8gdGhlIGxlZGdlcicpO1xyXG4gICAgICAgICAgICBsZXQgbmV3VmVuZG9yTGlzdCA6IFZlbmRvckxpc3QgPSBuZXcgVmVuZG9yTGlzdCh7SXRlbXM6IG5ld1ZlbmRvcnN9KTtcclxuICAgICAgICAgICAgYXdhaXQgcmVwby5jcmVhdGUobmV3VmVuZG9yTGlzdCk7XHJcbiAgICAgICAgICAgIHNhdmVkVmVuZG9ycyA9IG5ld1ZlbmRvckxpc3QuSXRlbXM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTWVyZ2UgdGhlIGV4aXN0aW5nIFZlbmRvciB3aXRoIHRoZSBuZXcgVmVuZG9yLCB1c2luZyBTS1UgYXMgYSB1bmlxdWUgaWRlbnRpZmllclxyXG4gICAgICAgICAgICBmb3IgKGxldCBjdXJyZW50TmV3VmVuZG9yIG9mIG5ld1ZlbmRvcnMpIHsgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggOiBudW1iZXIgPSBleGlzdGluZ1ZlbmRvckxpc3QuSXRlbXMuZmluZEluZGV4KCh2dixpaSxsbCk9PnsgcmV0dXJuIGN1cnJlbnROZXdWZW5kb3IuVmVuZG9ySUQgPT0gdnYuVmVuZG9ySUQ7IH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKGV4aXN0aW5nSXRlbUluZGV4ID4gLTEgKXsgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgaXRlbSB2YWx1ZXMgd2l0aCB0aGUgbmV3IHZhbHVlcyAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE5ld1ZlbmRvci5SZWNvcmRJRCA9IGV4aXN0aW5nVmVuZG9yTGlzdC5JdGVtc1tleGlzdGluZ0l0ZW1JbmRleF0uUmVjb3JkSUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdWZW5kb3JMaXN0Lkl0ZW1zW2V4aXN0aW5nSXRlbUluZGV4XSA9IGN1cnJlbnROZXdWZW5kb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgc2F2ZWRWZW5kb3JzLnB1c2goY3VycmVudE5ld1ZlbmRvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBhIGxpc3Qgb2YgcmVjb3JkcyB0aGF0IGFyZSBpbiB0aGUgbmV3IGxpc3QsIGJ1dCBub3QgaW4gdGhlIGV4aXN0aW5nIGxpc3RcclxuICAgICAgICAgICAgbGV0IG5ld1ZlbmRvck5vdEluRXhpc3RpbmdMaXN0IDogVmVuZG9yW10gPSBuZXdWZW5kb3JzLmZpbHRlcigodixpLGwpPT57IHJldHVybiAoZXhpc3RpbmdWZW5kb3JMaXN0Lkl0ZW1zLmZpbmRJbmRleCgodnYsaWksbGwpPT4geyByZXR1cm4gdi5WZW5kb3JJRCA9PSB2di5WZW5kb3JJRDsgfSkgPT0gLTEpOyB9KTtcclxuICAgICAgICAgICAgaWYgKG5ld1ZlbmRvck5vdEluRXhpc3RpbmdMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGV4aXN0aW5nVmVuZG9yTGlzdC5JdGVtcy5wdXNoKC4uLm5ld1ZlbmRvck5vdEluRXhpc3RpbmdMaXN0KTtcclxuICAgICAgICAgICAgICAgIHNhdmVkVmVuZG9ycy5wdXNoKC4uLm5ld1ZlbmRvck5vdEluRXhpc3RpbmdMaXN0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBIQUNLIDogVGhpcyBpcyBhIHRlbXBvcmFyeSBmaXggdG8gcmVtb3ZlIGRvdWJsZS1xdW90ZXMgZnJvbSBhbGwgVmVuZG9yIG5hbWVzLi4uLnRoaXMgc2hvdWxkIGJlIHJlbW92ZWQgYWZ0ZXIgYWxsIGVudHJpZXMgaGF2ZSBiZWVuIGZpeGVkIGluIHRoZSBibG9ja2NoYWluXHJcbiAgICAgICAgICAgIGV4aXN0aW5nVmVuZG9yTGlzdC5JdGVtcyA9IGV4aXN0aW5nVmVuZG9yTGlzdC5JdGVtcy5tYXAoKHYsaSxsKT0+e1xyXG4gICAgICAgICAgICAgICAgdi5OYW1lID0gdi5OYW1lLnJlcGxhY2UoL1tcIl0rL2csICcnKS50cmltKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdjtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBhd2FpdCByZXBvLnVwZGF0ZShleGlzdGluZ1ZlbmRvckxpc3QpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNhdmVkVmVuZG9ycztcclxuICAgIH1cclxuXHJcbiAgICAvLyBEZWxldGUgYW4gZXhpc3RpbmcgVmVuZG9yIHJlY29yZCBieSBpdHMgU0tVXHJcbiAgICBwdWJsaWMgYXN5bmMgZGVsZXRlVmVuZG9yKGN0eDogQ29udGV4dCwgc2t1OiBzdHJpbmcpIDogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFUlJPUjogZGVsZXRlVmVuZG9yIGhhcyBub3QgYmVlbiBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG5cclxuICAgIEBUcmFuc2FjdGlvbihmYWxzZSlcclxuICAgIEBSZXR1cm5zKCdWZW5kb3JbXScpXHJcbiAgICBwdWJsaWMgYXN5bmMgcmV0cmlldmVWZW5kb3IoY3R4OiBDb250ZXh0KTogUHJvbWlzZTxWZW5kb3JbXT4ge1xyXG4gICAgICAgIGxldCByZXBvIDogVmVuZG9yTGlzdFJlcG9zaXRvcnkgPSBuZXcgVmVuZG9yTGlzdFJlcG9zaXRvcnkoY3R4KTtcclxuICAgICAgICBjb25zdCB2ZW5kb3JMaXN0IDogVmVuZG9yTGlzdCA9IGF3YWl0IHJlcG8uZ2V0KCk7XHJcbiAgICAgICAgaWYgKHZlbmRvckxpc3QgPT09IHVuZGVmaW5lZCB8fCB2ZW5kb3JMaXN0Lkl0ZW1zID09PSB1bmRlZmluZWQgfHwgdmVuZG9yTGlzdC5JdGVtcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVSUk9SOiBObyBWZW5kb3JzIGV4aXN0IGluIHRoZSBibG9ja2NoYWluIGZvciB0aGlzIFZlbmRvcmApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2ZW5kb3JMaXN0Lkl0ZW1zO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0iXX0=