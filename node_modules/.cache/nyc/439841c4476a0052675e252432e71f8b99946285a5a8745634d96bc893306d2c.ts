"use strict";var cov_t4sjiyl0a=function(){var path="C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\___tests___\\adr-rule-contract.spec.ts";var hash="9a70be982fca2dd042119d2471f481400eb56303";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\___tests___\\adr-rule-contract.spec.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:25},end:{line:3,column:52}},"2":{start:{line:4,column:11},end:{line:4,column:24}},"3":{start:{line:5,column:13},end:{line:5,column:28}},"4":{start:{line:6,column:13},end:{line:6,column:28}},"5":{start:{line:7,column:23},end:{line:7,column:50}},"6":{start:{line:8,column:18},end:{line:8,column:39}},"7":{start:{line:9,column:0},end:{line:9,column:14}},"8":{start:{line:10,column:0},end:{line:10,column:25}},"9":{start:{line:11,column:0},end:{line:11,column:20}},"10":{start:{line:12,column:12},end:{line:12,column:25}},"11":{start:{line:13,column:17},end:{line:13,column:37}},"12":{start:{line:14,column:34},end:{line:14,column:81}},"13":{start:{line:15,column:19},end:{line:15,column:25}},"14":{start:{line:16,column:28},end:{line:16,column:38}},"15":{start:{line:17,column:0},end:{line:121,column:3}},"16":{start:{line:20,column:21},end:{line:20,column:23}},"17":{start:{line:21,column:4},end:{line:49,column:7}},"18":{start:{line:23,column:8},end:{line:23,column:45}},"19":{start:{line:24,column:8},end:{line:24,column:49}},"20":{start:{line:25,column:8},end:{line:25,column:55}},"21":{start:{line:27,column:8},end:{line:27,column:119}},"22":{start:{line:28,column:8},end:{line:28,column:89}},"23":{start:{line:29,column:8},end:{line:29,column:174}},"24":{start:{line:31,column:26},end:{line:45,column:9}},"25":{start:{line:32,column:33},end:{line:32,column:40}},"26":{start:{line:34,column:16},end:{line:34,column:46}},"27":{start:{line:35,column:16},end:{line:43,column:18}},"28":{start:{line:39,column:38},end:{line:39,column:43}},"29":{start:{line:40,column:40},end:{line:40,column:79}},"30":{start:{line:46,column:8},end:{line:46,column:45}},"31":{start:{line:47,column:8},end:{line:47,column:41}},"32":{start:{line:48,column:8},end:{line:48,column:125}},"33":{start:{line:50,column:4},end:{line:54,column:7}},"34":{start:{line:51,column:8},end:{line:53,column:11}},"35":{start:{line:52,column:12},end:{line:52,column:90}},"36":{start:{line:55,column:4},end:{line:111,column:7}},"37":{start:{line:56,column:8},end:{line:82,column:11}},"38":{start:{line:57,column:29},end:{line:74,column:13}},"39":{start:{line:76,column:12},end:{line:76,column:123}},"40":{start:{line:78,column:12},end:{line:78,column:40}},"41":{start:{line:79,column:32},end:{line:79,column:78}},"42":{start:{line:80,column:12},end:{line:80,column:199}},"43":{start:{line:81,column:12},end:{line:81,column:67}},"44":{start:{line:83,column:8},end:{line:110,column:11}},"45":{start:{line:84,column:35},end:{line:101,column:13}},"46":{start:{line:103,column:12},end:{line:103,column:123}},"47":{start:{line:105,column:37},end:{line:105,column:118}},"48":{start:{line:105,column:73},end:{line:105,column:115}},"49":{start:{line:106,column:12},end:{line:106,column:60}},"50":{start:{line:107,column:32},end:{line:107,column:84}},"51":{start:{line:108,column:12},end:{line:108,column:199}},"52":{start:{line:109,column:12},end:{line:109,column:73}},"53":{start:{line:112,column:4},end:{line:120,column:7}},"54":{start:{line:113,column:25},end:{line:113,column:78}},"55":{start:{line:114,column:8},end:{line:119,column:11}},"56":{start:{line:115,column:29},end:{line:115,column:113}},"57":{start:{line:116,column:27},end:{line:116,column:126}},"58":{start:{line:117,column:12},end:{line:117,column:186}},"59":{start:{line:118,column:12},end:{line:118,column:67}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:28},end:{line:17,column:29}},loc:{start:{line:17,column:34},end:{line:121,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:15},end:{line:21,column:16}},loc:{start:{line:21,column:21},end:{line:49,column:5}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:19},end:{line:32,column:20}},loc:{start:{line:32,column:31},end:{line:32,column:42}},line:32},"3":{name:"(anonymous_3)",decl:{start:{line:33,column:18},end:{line:33,column:19}},loc:{start:{line:33,column:30},end:{line:44,column:13}},line:33},"4":{name:"(anonymous_4)",decl:{start:{line:39,column:32},end:{line:39,column:33}},loc:{start:{line:39,column:38},end:{line:39,column:43}},line:39},"5":{name:"(anonymous_5)",decl:{start:{line:40,column:34},end:{line:40,column:35}},loc:{start:{line:40,column:40},end:{line:40,column:79}},line:40},"6":{name:"(anonymous_6)",decl:{start:{line:50,column:34},end:{line:50,column:35}},loc:{start:{line:50,column:40},end:{line:54,column:5}},line:50},"7":{name:"(anonymous_7)",decl:{start:{line:51,column:61},end:{line:51,column:62}},loc:{start:{line:51,column:73},end:{line:53,column:9}},line:51},"8":{name:"(anonymous_8)",decl:{start:{line:55,column:29},end:{line:55,column:30}},loc:{start:{line:55,column:35},end:{line:111,column:5}},line:55},"9":{name:"(anonymous_9)",decl:{start:{line:56,column:72},end:{line:56,column:73}},loc:{start:{line:56,column:84},end:{line:82,column:9}},line:56},"10":{name:"(anonymous_10)",decl:{start:{line:83,column:74},end:{line:83,column:75}},loc:{start:{line:83,column:86},end:{line:110,column:9}},line:83},"11":{name:"(anonymous_11)",decl:{start:{line:105,column:58},end:{line:105,column:59}},loc:{start:{line:105,column:71},end:{line:105,column:117}},line:105},"12":{name:"(anonymous_12)",decl:{start:{line:112,column:35},end:{line:112,column:36}},loc:{start:{line:112,column:41},end:{line:120,column:5}},line:112},"13":{name:"(anonymous_13)",decl:{start:{line:114,column:64},end:{line:114,column:65}},loc:{start:{line:114,column:76},end:{line:119,column:9}},line:114}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"9a70be982fca2dd042119d2471f481400eb56303"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_t4sjiyl0a.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const ___test_helper_1=(cov_t4sjiyl0a.s[1]++,require("./___test-helper"));const fs=(cov_t4sjiyl0a.s[2]++,require("fs"));const path=(cov_t4sjiyl0a.s[3]++,require("path"));const chai=(cov_t4sjiyl0a.s[4]++,require("chai"));const chaiAsPromised=(cov_t4sjiyl0a.s[5]++,require("chai-as-promised"));const sinonChai=(cov_t4sjiyl0a.s[6]++,require("sinon-chai"));cov_t4sjiyl0a.s[7]++;chai.should();cov_t4sjiyl0a.s[8]++;chai.use(chaiAsPromised);cov_t4sjiyl0a.s[9]++;chai.use(sinonChai);const __1=(cov_t4sjiyl0a.s[10]++,require(".."));const models_1=(cov_t4sjiyl0a.s[11]++,require("../models"));const vendor_shipped_contract_1=(cov_t4sjiyl0a.s[12]++,require("../contracts/vendor-shipped.contract"));const objectType=(cov_t4sjiyl0a.s[13]++,' ap ');const testconfigSubFolder=(cov_t4sjiyl0a.s[14]++,'adrRules');cov_t4sjiyl0a.s[15]++;describe('ADRRuleContract',()=>{cov_t4sjiyl0a.f[0]++;let contract;let ctx;let sampleADRs=(cov_t4sjiyl0a.s[16]++,[]);cov_t4sjiyl0a.s[17]++;beforeEach(()=>{cov_t4sjiyl0a.f[1]++;cov_t4sjiyl0a.s[18]++;// Prepare Context
contract=new __1.ADRRuleContract();cov_t4sjiyl0a.s[19]++;ctx=new ___test_helper_1.TestContext();cov_t4sjiyl0a.s[20]++;ctx.clientIdentity.getMSPID.returns('Org1MSP');// Add each ADR record, and record composite key creator
cov_t4sjiyl0a.s[21]++;sampleADRs=JSON.parse(fs.readFileSync(path.join(__dirname,'testconfigs','ADRTest.json')).toString('utf8'));cov_t4sjiyl0a.s[22]++;ctx.stub.createCompositeKey.withArgs('adr',['DEFAULT']).returns(' adr DEFAULT');cov_t4sjiyl0a.s[23]++;ctx.stub.getPrivateData.withArgs(___test_helper_1.testPDCName,' adr DEFAULT').resolves(Buffer.from(JSON.stringify(new models_1.ADRRuleList({Items:sampleADRs}))));// Add all records for the find search
let adrIterator=(cov_t4sjiyl0a.s[24]++,{close:async()=>{cov_t4sjiyl0a.f[2]++;cov_t4sjiyl0a.s[25]++;return;},next:async()=>{cov_t4sjiyl0a.f[3]++;cov_t4sjiyl0a.s[26]++;adrIterator['currentIndex']++;cov_t4sjiyl0a.s[27]++;return{value:{key:'adr',value:Buffer.from(JSON.stringify(adrIterator['allItems'][adrIterator['currentIndex']])),getKey:()=>{cov_t4sjiyl0a.f[4]++;cov_t4sjiyl0a.s[28]++;return'adr';},getValue:()=>{cov_t4sjiyl0a.f[5]++;cov_t4sjiyl0a.s[29]++;return Buffer.from(JSON.stringify(sampleADRs));}},done:adrIterator['allItems'].length==adrIterator['currentIndex']+1};}});cov_t4sjiyl0a.s[30]++;adrIterator['allItems']=sampleADRs;cov_t4sjiyl0a.s[31]++;adrIterator['currentIndex']=-1;cov_t4sjiyl0a.s[32]++;ctx.stub.getPrivateDataByPartialCompositeKey.withArgs(___test_helper_1.testPDCName,'adr',[]).resolves(adrIterator);});cov_t4sjiyl0a.s[33]++;describe('#retrieveADRRules',()=>{cov_t4sjiyl0a.f[6]++;cov_t4sjiyl0a.s[34]++;it('BR-ADR-001 should retrieve a list of ADR Rules',async()=>{cov_t4sjiyl0a.f[7]++;cov_t4sjiyl0a.s[35]++;await contract.retrieveADRRules(ctx).should.eventually.deep.equal(sampleADRs);});});cov_t4sjiyl0a.s[36]++;describe('#saveADRRule',()=>{cov_t4sjiyl0a.f[8]++;cov_t4sjiyl0a.s[37]++;it('BR-ADR-002 should merge new ADR Rules into existing rules',async()=>{cov_t4sjiyl0a.f[9]++;let newADRRule=(cov_t4sjiyl0a.s[38]++,{"RuleID":"BR-ADR-004","Description":"BR-ADR-001 : PO data is missing","Solution":"Don't Pay","Conditions":[{"RuleConditionID":"","RuleID":"","Description":"","FactType":"PurchaseOrderQuantityMatched","MinimumValue":0,"MinimumComparisonType":"==","MaximumValue":0,"MaximumComparisonType":"==","LastUpdatedDate":0}]});//Retrieving the existing ADRlist
cov_t4sjiyl0a.s[39]++;sampleADRs=JSON.parse(fs.readFileSync(path.join(__dirname,'testconfigs','ADRTest.json')).toString('utf8'));//ADRlist combining the existing ADR Rule and the new Rule
cov_t4sjiyl0a.s[40]++;sampleADRs.push(newADRRule);let resultADRRule=(cov_t4sjiyl0a.s[41]++,await contract.saveADRRules(ctx,[newADRRule]));cov_t4sjiyl0a.s[42]++;ctx.stub.putPrivateData.should.have.been.calledOnceWithExactly(___test_helper_1.testPDCName,' adr DEFAULT',Buffer.from(JSON.stringify(new models_1.ADRRuleList({Items:sampleADRs}))));cov_t4sjiyl0a.s[43]++;chai.expect(resultADRRule).to.deep.equal([newADRRule]);});cov_t4sjiyl0a.s[44]++;it('BR-ADR-003 should replace matching ADR Rules with new rules',async()=>{cov_t4sjiyl0a.f[10]++;let replacingADRRule=(cov_t4sjiyl0a.s[45]++,{"RuleID":"BR-ADR-001","Description":"BR-ADR-001 : Replacing existing ADR rule","Solution":"Pay","Conditions":[{"RuleConditionID":"","RuleID":"","Description":"","FactType":"RDCReceivedQuantityMatched","MinimumValue":0,"MinimumComparisonType":"==","MaximumValue":0,"MaximumComparisonType":"==","LastUpdatedDate":0}]});//Retrieving the existing ADRlist
cov_t4sjiyl0a.s[46]++;sampleADRs=JSON.parse(fs.readFileSync(path.join(__dirname,'testconfigs','ADRTest.json')).toString('utf8'));//Replacing the existing ADR rule with the new matching ADR rule
const existingadrindex=(cov_t4sjiyl0a.s[47]++,sampleADRs.findIndex((v,i,l)=>{cov_t4sjiyl0a.f[11]++;cov_t4sjiyl0a.s[48]++;return v.RuleID=replacingADRRule.RuleID;}));cov_t4sjiyl0a.s[49]++;sampleADRs[existingadrindex]=replacingADRRule;let resultADRRule=(cov_t4sjiyl0a.s[50]++,await contract.saveADRRules(ctx,[replacingADRRule]));cov_t4sjiyl0a.s[51]++;ctx.stub.putPrivateData.should.have.been.calledOnceWithExactly(___test_helper_1.testPDCName,' adr DEFAULT',Buffer.from(JSON.stringify(new models_1.ADRRuleList({Items:sampleADRs}))));cov_t4sjiyl0a.s[52]++;chai.expect(resultADRRule).to.deep.equal([replacingADRRule]);});});cov_t4sjiyl0a.s[53]++;describe('#saveVendorShipped',()=>{cov_t4sjiyl0a.f[12]++;let vsContract=(cov_t4sjiyl0a.s[54]++,new vendor_shipped_contract_1.VendorShippedContract());cov_t4sjiyl0a.s[55]++;it('BR-ADR-004 should not pay when PO data is missing',async()=>{cov_t4sjiyl0a.f[13]++;let testConfig=(cov_t4sjiyl0a.s[56]++,___test_helper_1.TestHelper.loadAPTestConfig('BR-ADR-004',ctx,testconfigSubFolder));let resultAP=(cov_t4sjiyl0a.s[57]++,await vsContract.saveVendorShipped(ctx,testConfig.input.PONumber,testConfig.input.VendorShippeds));cov_t4sjiyl0a.s[58]++;ctx.stub.putPrivateData.should.have.been.calledOnceWith(___test_helper_1.testPDCName,objectType+testConfig.input.PONumber,Buffer.from(JSON.stringify(testConfig.output)));cov_t4sjiyl0a.s[59]++;chai.expect(testConfig.output).to.deep.equal(resultAP);});});});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxfX190ZXN0c19fX1xcYWRyLXJ1bGUtY29udHJhY3Quc3BlYy50cyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxfX190ZXN0c19fX1xcYWRyLXJ1bGUtY29udHJhY3Quc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHFEQUF3RTtBQUV4RSx5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLDZCQUE2QjtBQUM3QixtREFBbUQ7QUFFbkQsd0NBQXdDO0FBR3hDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNkLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDekIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQVVwQiwwQkFBcUM7QUFDckMsc0NBQTJIO0FBRzNILGtGQUE2RTtBQUU3RSxNQUFNLFVBQVUsR0FBWSxNQUFNLENBQUM7QUFDbkMsTUFBTSxtQkFBbUIsR0FBWSxVQUFVLENBQUM7QUFFaEQsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtJQUU3QixJQUFJLFFBQXlCLENBQUM7SUFDOUIsSUFBSSxHQUFnQixDQUFDO0lBRXJCLElBQUksVUFBVSxHQUFlLEVBQUUsQ0FBQztJQUVoQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osa0JBQWtCO1FBQ2xCLFFBQVEsR0FBRyxJQUFJLG1CQUFlLEVBQUUsQ0FBQztRQUNqQyxHQUFHLEdBQUcsSUFBSSw0QkFBVyxFQUFFLENBQUM7UUFDeEIsR0FBRyxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBRS9DLHdEQUF3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QUFLLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7UUFFakUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7UUFDaEMsSUFBSSxVQUFVLEdBQTJCLElBQUksK0NBQXFCLEVBQUUsQ0FBQztRQUVyRSxFQUFFLENBQUMsbURBQW1ELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDL0QsSUFBSSxVQUFVLEdBQUcsMkJBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFLG1CQUFtQixDQUFDLENBQUM7WUFDckYsSUFBSSxRQUFRLEdBQXNCLE1BQU0sVUFBVSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxVQUFVLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ3RJLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyw0QkFBVyxFQUFFLFVBQVUsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3SixJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBSVAsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZXN0SGVscGVyLCBUZXN0Q29udGV4dCwgdGVzdFBEQ05hbWUgfSBmcm9tICcuL19fX3Rlc3QtaGVscGVyJztcclxuXHJcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0ICogYXMgY2hhaSBmcm9tICdjaGFpJztcclxuaW1wb3J0ICogYXMgY2hhaUFzUHJvbWlzZWQgZnJvbSAnY2hhaS1hcy1wcm9taXNlZCc7XHJcbmltcG9ydCAqIGFzIHNpbm9uIGZyb20gJ3Npbm9uJztcclxuaW1wb3J0ICogYXMgc2lub25DaGFpIGZyb20gJ3Npbm9uLWNoYWknO1xyXG5pbXBvcnQgd2luc3RvbiA9IHJlcXVpcmUoJ3dpbnN0b24nKTtcclxuXHJcbmNoYWkuc2hvdWxkKCk7XHJcbmNoYWkudXNlKGNoYWlBc1Byb21pc2VkKTtcclxuY2hhaS51c2Uoc2lub25DaGFpKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuaW1wb3J0IHsgQURSUnVsZUNvbnRyYWN0IH0gZnJvbSAnLi4nO1xyXG5pbXBvcnQgeyBBc3NldFByb2N1cmVtZW50LCBVbml0T2ZNZWFzdXJlLCBEaXNjcmVwYW5jeSwgRGlzY3JlcGFuY3lUeXBlLCBTdGFnZVR5cGUsIEFEUlJ1bGUsIEFEUlJ1bGVMaXN0IH0gZnJvbSAnLi4vbW9kZWxzJztcclxuaW1wb3J0IHsgUHVyY2hhc2VPcmRlckNvbnRyYWN0IH0gZnJvbSAnLi4vY29udHJhY3RzL3B1cmNoYXNlLW9yZGVyLmNvbnRyYWN0JztcclxuaW1wb3J0IHsgQ2hhaW5jb2RlU3R1YiwgQ2xpZW50SWRlbnRpdHksIEl0ZXJhdG9ycyB9IGZyb20gJ2ZhYnJpYy1zaGltJztcclxuaW1wb3J0IHsgVmVuZG9yU2hpcHBlZENvbnRyYWN0IH0gZnJvbSAnLi4vY29udHJhY3RzL3ZlbmRvci1zaGlwcGVkLmNvbnRyYWN0JztcclxuXHJcbmNvbnN0IG9iamVjdFR5cGUgOiBzdHJpbmcgPSAnIGFwICc7XHJcbmNvbnN0IHRlc3Rjb25maWdTdWJGb2xkZXIgOiBzdHJpbmcgPSAnYWRyUnVsZXMnO1xyXG5cclxuZGVzY3JpYmUoJ0FEUlJ1bGVDb250cmFjdCcsICgpID0+IHtcclxuXHJcbiAgICBsZXQgY29udHJhY3Q6IEFEUlJ1bGVDb250cmFjdDtcclxuICAgIGxldCBjdHg6IFRlc3RDb250ZXh0O1xyXG5cclxuICAgIGxldCBzYW1wbGVBRFJzIDogQURSUnVsZVtdID0gW107XHJcblxyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgICAgLy8gUHJlcGFyZSBDb250ZXh0XHJcbiAgICAgICAgY29udHJhY3QgPSBuZXcgQURSUnVsZUNvbnRyYWN0KCk7XHJcbiAgICAgICAgY3R4ID0gbmV3IFRlc3RDb250ZXh0KCk7XHJcbiAgICAgICAgY3R4LmNsaWVudElkZW50aXR5LmdldE1TUElELnJldHVybnMoJ09yZzFNU1AnKTtcclxuXHJcbiAgICAgICAgLy8gQWRkIGVhY2ggQURSIHJlY29yZCwgYW5kIHJlY29yZCBjb21wb3NpdGUga2V5IGNyZWF0b3JcclxuICAgICAgICBzYW1wbGVBRFJzID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgJ3Rlc3Rjb25maWdzJywgJ0FEUlRlc3QuanNvbicpKS50b1N0cmluZygndXRmOCcpKTtcclxuICAgICAgICBjdHguc3R1Yi5jcmVhdGVDb21wb3NpdGVLZXkud2l0aEFyZ3MoJ2FkcicsIFsnREVGQVVMVCddKS5yZXR1cm5zKCcgYWRyIERFRkFVTFQnKTtcclxuICAgICAgICBjdHguc3R1Yi5nZXRQcml2YXRlRGF0YS53aXRoQXJncyh0ZXN0UERDTmFtZSwgJyBhZHIgREVGQVVMVCcpLnJlc29sdmVzKEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KG5ldyBBRFJSdWxlTGlzdCh7IEl0ZW1zOiBzYW1wbGVBRFJzIH0pKSkpO1xyXG5cclxuICAgICAgICAvLyBBZGQgYWxsIHJlY29yZHMgZm9yIHRoZSBmaW5kIHNlYXJjaFxyXG4gICAgICAgIGxldCBhZHJJdGVyYXRvciA6IEl0ZXJhdG9ycy5TdGF0ZVF1ZXJ5SXRlcmF0b3IgPSB7XHJcbiAgICAgICAgICAgIGNsb3NlOiBhc3luYyAoKSA9PiB7IHJldHVybjsgfSxcclxuICAgICAgICAgICAgbmV4dDogYXN5bmMgKCkgPT4geyBcclxuICAgICAgICAgICAgICAgIGFkckl0ZXJhdG9yWydjdXJyZW50SW5kZXgnXSsrO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiAnYWRyJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGFkckl0ZXJhdG9yWydhbGxJdGVtcyddW2Fkckl0ZXJhdG9yWydjdXJyZW50SW5kZXgnXV0pKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0S2V5OiAoKT0+J2FkcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldFZhbHVlOiAoKT0+QnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkoc2FtcGxlQURScykpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBhcyBJdGVyYXRvcnMuS1YsXHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZSA6IChhZHJJdGVyYXRvclsnYWxsSXRlbXMnXS5sZW5ndGggPT0gYWRySXRlcmF0b3JbJ2N1cnJlbnRJbmRleCddKzEpXHJcbiAgICAgICAgICAgICAgICB9IGFzIEl0ZXJhdG9ycy5OZXh0UmVzdWx0OyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gYXMgSXRlcmF0b3JzLlN0YXRlUXVlcnlJdGVyYXRvcjtcclxuXHJcbiAgICAgICAgYWRySXRlcmF0b3JbJ2FsbEl0ZW1zJ10gPSBzYW1wbGVBRFJzO1xyXG4gICAgICAgIGFkckl0ZXJhdG9yWydjdXJyZW50SW5kZXgnXSA9IC0xO1xyXG5cclxuICAgICAgICBjdHguc3R1Yi5nZXRQcml2YXRlRGF0YUJ5UGFydGlhbENvbXBvc2l0ZUtleS53aXRoQXJncyh0ZXN0UERDTmFtZSwgJ2FkcicsIFtdKS5yZXNvbHZlcyhhZHJJdGVyYXRvcik7XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJyNyZXRyaWV2ZUFEUlJ1bGVzJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdCUi1BRFItMDAxIHNob3VsZCByZXRyaWV2ZSBhIGxpc3Qgb2YgQURSIFJ1bGVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCBjb250cmFjdC5yZXRyaWV2ZUFEUlJ1bGVzKGN0eCkuc2hvdWxkLmV2ZW50dWFsbHkuZGVlcC5lcXVhbChzYW1wbGVBRFJzKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCcjc2F2ZUFEUlJ1bGUnLCAoKSA9PiB7XHJcbiAgICAgICAgaXQoJ0JSLUFEUi0wMDIgc2hvdWxkIG1lcmdlIG5ldyBBRFIgUnVsZXMgaW50byBleGlzdGluZyBydWxlcycsIGFzeW5jICgpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGxldCBuZXdBRFJSdWxlOiBBRFJSdWxlID0ge1xyXG4gICAgICAgICAgICAgICAgXCJSdWxlSURcIiA6IFwiQlItQURSLTAwNFwiLFxyXG4gICAgICAgICAgICAgICAgXCJEZXNjcmlwdGlvblwiIDogXCJCUi1BRFItMDAxIDogUE8gZGF0YSBpcyBtaXNzaW5nXCIsXHJcbiAgICAgICAgICAgICAgICBcIlNvbHV0aW9uXCIgOiBcIkRvbid0IFBheVwiLFxyXG4gICAgICAgICAgICAgICAgXCJDb25kaXRpb25zXCIgOiBbXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlJ1bGVDb25kaXRpb25JRFwiIDogXCJcIiwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiUnVsZUlEXCIgOiAgXCJcIiwgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkRlc2NyaXB0aW9uXCIgOiAgXCJcIiwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRmFjdFR5cGVcIiA6IFwiUHVyY2hhc2VPcmRlclF1YW50aXR5TWF0Y2hlZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1pbmltdW1WYWx1ZVwiIDogMCwgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1pbmltdW1Db21wYXJpc29uVHlwZVwiIDogXCI9PVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1heGltdW1WYWx1ZVwiIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJNYXhpbXVtQ29tcGFyaXNvblR5cGVcIiA6IFwiPT1cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJMYXN0VXBkYXRlZERhdGVcIiA6IDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdICBcclxuICAgICAgICAgICAgfSBhcyBBRFJSdWxlO1xyXG5cclxuICAgICAgICAgICAgLy9SZXRyaWV2aW5nIHRoZSBleGlzdGluZyBBRFJsaXN0XHJcbiAgICAgICAgICAgIHNhbXBsZUFEUnMgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAndGVzdGNvbmZpZ3MnLCAnQURSVGVzdC5qc29uJykpLnRvU3RyaW5nKCd1dGY4JykpO1xyXG5cclxuICAgICAgICAgICAgLy9BRFJsaXN0IGNvbWJpbmluZyB0aGUgZXhpc3RpbmcgQURSIFJ1bGUgYW5kIHRoZSBuZXcgUnVsZVxyXG4gICAgICAgICAgICBzYW1wbGVBRFJzLnB1c2gobmV3QURSUnVsZSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgcmVzdWx0QURSUnVsZSA6IEFEUlJ1bGVbXSA9IGF3YWl0IGNvbnRyYWN0LnNhdmVBRFJSdWxlcyhjdHgsIFtuZXdBRFJSdWxlXSk7XHJcblxyXG4gICAgICAgICAgICBjdHguc3R1Yi5wdXRQcml2YXRlRGF0YS5zaG91bGQuaGF2ZS5iZWVuLmNhbGxlZE9uY2VXaXRoRXhhY3RseSh0ZXN0UERDTmFtZSwgJyBhZHIgREVGQVVMVCcsIEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KG5ldyBBRFJSdWxlTGlzdCh7IEl0ZW1zOiBzYW1wbGVBRFJzIH0pKSkpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY2hhaS5leHBlY3QocmVzdWx0QURSUnVsZSkudG8uZGVlcC5lcXVhbChbbmV3QURSUnVsZV0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnQlItQURSLTAwMyBzaG91bGQgcmVwbGFjZSBtYXRjaGluZyBBRFIgUnVsZXMgd2l0aCBuZXcgcnVsZXMnLCBhc3luYyAoKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBsZXQgcmVwbGFjaW5nQURSUnVsZTogQURSUnVsZSA9ICB7XHJcbiAgICAgICAgICAgICAgICBcIlJ1bGVJRFwiIDogXCJCUi1BRFItMDAxXCIsXHJcbiAgICAgICAgICAgICAgICBcIkRlc2NyaXB0aW9uXCIgOiBcIkJSLUFEUi0wMDEgOiBSZXBsYWNpbmcgZXhpc3RpbmcgQURSIHJ1bGVcIixcclxuICAgICAgICAgICAgICAgIFwiU29sdXRpb25cIiA6IFwiUGF5XCIsXHJcbiAgICAgICAgICAgICAgICBcIkNvbmRpdGlvbnNcIiA6IFtcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiUnVsZUNvbmRpdGlvbklEXCIgOiBcIlwiLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJSdWxlSURcIiA6ICBcIlwiLCAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRGVzY3JpcHRpb25cIiA6ICBcIlwiLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJGYWN0VHlwZVwiIDogXCJSRENSZWNlaXZlZFF1YW50aXR5TWF0Y2hlZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1pbmltdW1WYWx1ZVwiIDogMCwgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1pbmltdW1Db21wYXJpc29uVHlwZVwiIDogXCI9PVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIk1heGltdW1WYWx1ZVwiIDogMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJNYXhpbXVtQ29tcGFyaXNvblR5cGVcIiA6IFwiPT1cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJMYXN0VXBkYXRlZERhdGVcIiA6IDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBdICBcclxuICAgICAgICAgICAgfSBhcyBBRFJSdWxlO1xyXG5cclxuICAgICAgICAgICAgLy9SZXRyaWV2aW5nIHRoZSBleGlzdGluZyBBRFJsaXN0XHJcbiAgICAgICAgICAgIHNhbXBsZUFEUnMgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCAndGVzdGNvbmZpZ3MnLCAnQURSVGVzdC5qc29uJykpLnRvU3RyaW5nKCd1dGY4JykpO1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8vUmVwbGFjaW5nIHRoZSBleGlzdGluZyBBRFIgcnVsZSB3aXRoIHRoZSBuZXcgbWF0Y2hpbmcgQURSIHJ1bGVcclxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdhZHJpbmRleCA9IHNhbXBsZUFEUnMuZmluZEluZGV4KCh2LGksbCk9PiB7IHJldHVybiB2LlJ1bGVJRCA9IHJlcGxhY2luZ0FEUlJ1bGUuUnVsZUlEfSk7XHJcbiAgICAgICAgICAgIHNhbXBsZUFEUnNbZXhpc3RpbmdhZHJpbmRleF0gPSByZXBsYWNpbmdBRFJSdWxlO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJlc3VsdEFEUlJ1bGUgOiBBRFJSdWxlW10gPSBhd2FpdCBjb250cmFjdC5zYXZlQURSUnVsZXMoY3R4LCBbcmVwbGFjaW5nQURSUnVsZV0pO1xyXG5cclxuICAgICAgICAgICAgY3R4LnN0dWIucHV0UHJpdmF0ZURhdGEuc2hvdWxkLmhhdmUuYmVlbi5jYWxsZWRPbmNlV2l0aEV4YWN0bHkodGVzdFBEQ05hbWUsICcgYWRyIERFRkFVTFQnLCBCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShuZXcgQURSUnVsZUxpc3QoeyBJdGVtczogc2FtcGxlQURScyB9KSkpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNoYWkuZXhwZWN0KHJlc3VsdEFEUlJ1bGUpLnRvLmRlZXAuZXF1YWwoW3JlcGxhY2luZ0FEUlJ1bGVdKTtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnI3NhdmVWZW5kb3JTaGlwcGVkJywgKCkgPT4ge1xyXG4gICAgICAgIGxldCB2c0NvbnRyYWN0IDogVmVuZG9yU2hpcHBlZENvbnRyYWN0ID0gbmV3IFZlbmRvclNoaXBwZWRDb250cmFjdCgpO1xyXG5cclxuICAgICAgICBpdCgnQlItQURSLTAwNCBzaG91bGQgbm90IHBheSB3aGVuIFBPIGRhdGEgaXMgbWlzc2luZycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRlc3RDb25maWcgPSBUZXN0SGVscGVyLmxvYWRBUFRlc3RDb25maWcoJ0JSLUFEUi0wMDQnLCBjdHgsIHRlc3Rjb25maWdTdWJGb2xkZXIpO1xyXG4gICAgICAgICAgICBsZXQgcmVzdWx0QVAgOiBBc3NldFByb2N1cmVtZW50ID0gYXdhaXQgdnNDb250cmFjdC5zYXZlVmVuZG9yU2hpcHBlZChjdHgsIHRlc3RDb25maWcuaW5wdXQuUE9OdW1iZXIsIHRlc3RDb25maWcuaW5wdXQuVmVuZG9yU2hpcHBlZHMpO1xyXG4gICAgICAgICAgICBjdHguc3R1Yi5wdXRQcml2YXRlRGF0YS5zaG91bGQuaGF2ZS5iZWVuLmNhbGxlZE9uY2VXaXRoKHRlc3RQRENOYW1lLCBvYmplY3RUeXBlICsgdGVzdENvbmZpZy5pbnB1dC5QT051bWJlciwgQnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkodGVzdENvbmZpZy5vdXRwdXQpKSk7XHJcbiAgICAgICAgICAgIGNoYWkuZXhwZWN0KHRlc3RDb25maWcub3V0cHV0KS50by5kZWVwLmVxdWFsKHJlc3VsdEFQKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG59KTsiXX0=