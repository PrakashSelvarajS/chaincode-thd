"use strict";var cov_74t5inh3w=function(){var path="C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\adr-rule.contract.ts";var hash="5c7378e7670a48a32cf913928ba124f2149542b2";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\contracts\\adr-rule.contract.ts",statementMap:{"0":{start:{line:2,column:17},end:{line:7,column:1}},"1":{start:{line:3,column:12},end:{line:3,column:28}},"2":{start:{line:3,column:34},end:{line:3,column:125}},"3":{start:{line:4,column:4},end:{line:5,column:150}},"4":{start:{line:4,column:79},end:{line:4,column:131}},"5":{start:{line:5,column:9},end:{line:5,column:150}},"6":{start:{line:5,column:22},end:{line:5,column:43}},"7":{start:{line:5,column:58},end:{line:5,column:150}},"8":{start:{line:5,column:81},end:{line:5,column:150}},"9":{start:{line:6,column:4},end:{line:6,column:66}},"10":{start:{line:8,column:17},end:{line:10,column:1}},"11":{start:{line:9,column:4},end:{line:9,column:109}},"12":{start:{line:9,column:79},end:{line:9,column:109}},"13":{start:{line:11,column:0},end:{line:11,column:62}},"14":{start:{line:12,column:30},end:{line:12,column:60}},"15":{start:{line:13,column:17},end:{line:13,column:37}},"16":{start:{line:14,column:23},end:{line:14,column:49}},"17":{start:{line:15,column:22},end:{line:60,column:1}},"18":{start:{line:16,column:20},end:{line:16,column:71}},"19":{start:{line:18,column:19},end:{line:18,column:64}},"20":{start:{line:19,column:25},end:{line:19,column:41}},"21":{start:{line:20,column:8},end:{line:25,column:9}},"22":{start:{line:21,column:12},end:{line:21,column:90}},"23":{start:{line:24,column:12},end:{line:24,column:34}},"24":{start:{line:30,column:19},end:{line:30,column:64}},"25":{start:{line:31,column:35},end:{line:31,column:51}},"26":{start:{line:32,column:28},end:{line:32,column:30}},"27":{start:{line:33,column:8},end:{line:57,column:9}},"28":{start:{line:35,column:12},end:{line:35,column:87}},"29":{start:{line:36,column:34},end:{line:36,column:60}},"30":{start:{line:37,column:12},end:{line:37,column:48}},"31":{start:{line:38,column:12},end:{line:38,column:65}},"32":{start:{line:39,column:12},end:{line:39,column:50}},"33":{start:{line:42,column:12},end:{line:49,column:13}},"34":{start:{line:43,column:42},end:{line:43,column:138}},"35":{start:{line:43,column:94},end:{line:43,column:135}},"36":{start:{line:44,column:16},end:{line:48,column:17}},"37":{start:{line:46,column:20},end:{line:46,column:83}},"38":{start:{line:47,column:20},end:{line:47,column:55}},"39":{start:{line:51,column:47},end:{line:51,column:187}},"40":{start:{line:51,column:81},end:{line:51,column:184}},"41":{start:{line:51,column:144},end:{line:51,column:173}},"42":{start:{line:52,column:12},end:{line:55,column:13}},"43":{start:{line:53,column:16},end:{line:53,column:81}},"44":{start:{line:54,column:16},end:{line:54,column:68}},"45":{start:{line:56,column:12},end:{line:56,column:75}},"46":{start:{line:58,column:8},end:{line:58,column:29}},"47":{start:{line:61,column:0},end:{line:67,column:56}},"48":{start:{line:68,column:0},end:{line:75,column:52}},"49":{start:{line:76,column:0},end:{line:79,column:20}},"50":{start:{line:80,column:0},end:{line:80,column:42}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:46},end:{line:2,column:47}},loc:{start:{line:2,column:87},end:{line:7,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:46},end:{line:8,column:47}},loc:{start:{line:8,column:62},end:{line:10,column:1}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:16,column:4},end:{line:16,column:5}},loc:{start:{line:16,column:18},end:{line:16,column:73}},line:16},"3":{name:"(anonymous_3)",decl:{start:{line:17,column:4},end:{line:17,column:5}},loc:{start:{line:17,column:32},end:{line:26,column:5}},line:17},"4":{name:"(anonymous_4)",decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:41},end:{line:59,column:5}},line:28},"5":{name:"(anonymous_5)",decl:{start:{line:43,column:79},end:{line:43,column:80}},loc:{start:{line:43,column:92},end:{line:43,column:137}},line:43},"6":{name:"(anonymous_6)",decl:{start:{line:51,column:66},end:{line:51,column:67}},loc:{start:{line:51,column:79},end:{line:51,column:186}},line:51},"7":{name:"(anonymous_7)",decl:{start:{line:51,column:126},end:{line:51,column:127}},loc:{start:{line:51,column:142},end:{line:51,column:175}},line:51}},branchMap:{"0":{loc:{start:{line:2,column:17},end:{line:7,column:1}},type:"binary-expr",locations:[{start:{line:2,column:18},end:{line:2,column:22}},{start:{line:2,column:26},end:{line:2,column:41}},{start:{line:2,column:46},end:{line:7,column:1}}],line:2},"1":{loc:{start:{line:3,column:34},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:42},end:{line:3,column:48}},{start:{line:3,column:51},end:{line:3,column:125}}],line:3},"2":{loc:{start:{line:3,column:51},end:{line:3,column:125}},type:"cond-expr",locations:[{start:{line:3,column:67},end:{line:3,column:118}},{start:{line:3,column:121},end:{line:3,column:125}}],line:3},"3":{loc:{start:{line:4,column:4},end:{line:5,column:150}},type:"if",locations:[{start:{line:4,column:4},end:{line:5,column:150}},{start:{line:4,column:4},end:{line:5,column:150}}],line:4},"4":{loc:{start:{line:4,column:8},end:{line:4,column:77}},type:"binary-expr",locations:[{start:{line:4,column:8},end:{line:4,column:35}},{start:{line:4,column:39},end:{line:4,column:77}}],line:4},"5":{loc:{start:{line:5,column:58},end:{line:5,column:150}},type:"if",locations:[{start:{line:5,column:58},end:{line:5,column:150}},{start:{line:5,column:58},end:{line:5,column:150}}],line:5},"6":{loc:{start:{line:5,column:85},end:{line:5,column:149}},type:"binary-expr",locations:[{start:{line:5,column:86},end:{line:5,column:143}},{start:{line:5,column:148},end:{line:5,column:149}}],line:5},"7":{loc:{start:{line:5,column:86},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:94},end:{line:5,column:98}},{start:{line:5,column:101},end:{line:5,column:143}}],line:5},"8":{loc:{start:{line:5,column:101},end:{line:5,column:143}},type:"cond-expr",locations:[{start:{line:5,column:109},end:{line:5,column:126}},{start:{line:5,column:129},end:{line:5,column:143}}],line:5},"9":{loc:{start:{line:6,column:11},end:{line:6,column:62}},type:"binary-expr",locations:[{start:{line:6,column:11},end:{line:6,column:16}},{start:{line:6,column:20},end:{line:6,column:21}},{start:{line:6,column:25},end:{line:6,column:62}}],line:6},"10":{loc:{start:{line:8,column:17},end:{line:10,column:1}},type:"binary-expr",locations:[{start:{line:8,column:18},end:{line:8,column:22}},{start:{line:8,column:26},end:{line:8,column:41}},{start:{line:8,column:46},end:{line:10,column:1}}],line:8},"11":{loc:{start:{line:9,column:4},end:{line:9,column:109}},type:"if",locations:[{start:{line:9,column:4},end:{line:9,column:109}},{start:{line:9,column:4},end:{line:9,column:109}}],line:9},"12":{loc:{start:{line:9,column:8},end:{line:9,column:77}},type:"binary-expr",locations:[{start:{line:9,column:8},end:{line:9,column:35}},{start:{line:9,column:39},end:{line:9,column:77}}],line:9},"13":{loc:{start:{line:20,column:8},end:{line:25,column:9}},type:"if",locations:[{start:{line:20,column:8},end:{line:25,column:9}},{start:{line:20,column:8},end:{line:25,column:9}}],line:20},"14":{loc:{start:{line:20,column:12},end:{line:20,column:96}},type:"binary-expr",locations:[{start:{line:20,column:12},end:{line:20,column:34}},{start:{line:20,column:38},end:{line:20,column:66}},{start:{line:20,column:70},end:{line:20,column:96}}],line:20},"15":{loc:{start:{line:33,column:8},end:{line:57,column:9}},type:"if",locations:[{start:{line:33,column:8},end:{line:57,column:9}},{start:{line:33,column:8},end:{line:57,column:9}}],line:33},"16":{loc:{start:{line:33,column:12},end:{line:33,column:133}},type:"binary-expr",locations:[{start:{line:33,column:12},end:{line:33,column:46}},{start:{line:33,column:50},end:{line:33,column:90}},{start:{line:33,column:94},end:{line:33,column:133}}],line:33},"17":{loc:{start:{line:44,column:16},end:{line:48,column:17}},type:"if",locations:[{start:{line:44,column:16},end:{line:48,column:17}},{start:{line:44,column:16},end:{line:48,column:17}}],line:44},"18":{loc:{start:{line:52,column:12},end:{line:55,column:13}},type:"if",locations:[{start:{line:52,column:12},end:{line:55,column:13}},{start:{line:52,column:12},end:{line:55,column:13}}],line:52}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0,0],"17":[0,0],"18":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"5c7378e7670a48a32cf913928ba124f2149542b2"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var __decorate=(cov_74t5inh3w.s[0]++,(cov_74t5inh3w.b[0][0]++,this)&&(cov_74t5inh3w.b[0][1]++,this.__decorate)||(cov_74t5inh3w.b[0][2]++,function(decorators,target,key,desc){cov_74t5inh3w.f[0]++;var c=(cov_74t5inh3w.s[1]++,arguments.length),r=(cov_74t5inh3w.s[2]++,c<3?(cov_74t5inh3w.b[1][0]++,target):(cov_74t5inh3w.b[1][1]++,desc===null?(cov_74t5inh3w.b[2][0]++,desc=Object.getOwnPropertyDescriptor(target,key)):(cov_74t5inh3w.b[2][1]++,desc))),d;cov_74t5inh3w.s[3]++;if((cov_74t5inh3w.b[4][0]++,typeof Reflect==="object")&&(cov_74t5inh3w.b[4][1]++,typeof Reflect.decorate==="function")){cov_74t5inh3w.b[3][0]++;cov_74t5inh3w.s[4]++;r=Reflect.decorate(decorators,target,key,desc);}else{cov_74t5inh3w.b[3][1]++;cov_74t5inh3w.s[5]++;for(var i=(cov_74t5inh3w.s[6]++,decorators.length-1);i>=0;i--){cov_74t5inh3w.s[7]++;if(d=decorators[i]){cov_74t5inh3w.b[5][0]++;cov_74t5inh3w.s[8]++;r=(cov_74t5inh3w.b[6][0]++,c<3?(cov_74t5inh3w.b[7][0]++,d(r)):(cov_74t5inh3w.b[7][1]++,c>3?(cov_74t5inh3w.b[8][0]++,d(target,key,r)):(cov_74t5inh3w.b[8][1]++,d(target,key))))||(cov_74t5inh3w.b[6][1]++,r);}else{cov_74t5inh3w.b[5][1]++;}}}cov_74t5inh3w.s[9]++;return(cov_74t5inh3w.b[9][0]++,c>3)&&(cov_74t5inh3w.b[9][1]++,r)&&(cov_74t5inh3w.b[9][2]++,Object.defineProperty(target,key,r)),r;}));var __metadata=(cov_74t5inh3w.s[10]++,(cov_74t5inh3w.b[10][0]++,this)&&(cov_74t5inh3w.b[10][1]++,this.__metadata)||(cov_74t5inh3w.b[10][2]++,function(k,v){cov_74t5inh3w.f[1]++;cov_74t5inh3w.s[11]++;if((cov_74t5inh3w.b[12][0]++,typeof Reflect==="object")&&(cov_74t5inh3w.b[12][1]++,typeof Reflect.metadata==="function")){cov_74t5inh3w.b[11][0]++;cov_74t5inh3w.s[12]++;return Reflect.metadata(k,v);}else{cov_74t5inh3w.b[11][1]++;}}));cov_74t5inh3w.s[13]++;Object.defineProperty(exports,"__esModule",{value:true});const fabric_contract_api_1=(cov_74t5inh3w.s[14]++,require("fabric-contract-api"));const models_1=(cov_74t5inh3w.s[15]++,require("../models"));const repositories_1=(cov_74t5inh3w.s[16]++,require("../repositories"));cov_74t5inh3w.s[17]++;let ADRRuleContract=class ADRRuleContract extends fabric_contract_api_1.Contract{constructor(){cov_74t5inh3w.f[2]++;cov_74t5inh3w.s[18]++;super("com.homedepot.procurement.ADRRuleContract");}async retrieveADRRules(ctx){cov_74t5inh3w.f[3]++;let repo=(cov_74t5inh3w.s[19]++,new repositories_1.ADRRuleListRepository(ctx));const ruleList=(cov_74t5inh3w.s[20]++,await repo.get());cov_74t5inh3w.s[21]++;if((cov_74t5inh3w.b[14][0]++,ruleList===undefined)||(cov_74t5inh3w.b[14][1]++,ruleList.Items===undefined)||(cov_74t5inh3w.b[14][2]++,ruleList.Items.length==0)){cov_74t5inh3w.b[13][0]++;cov_74t5inh3w.s[22]++;throw new Error(`ERROR: No ADRRules exist in the blockchain for this Vendor`);}else{cov_74t5inh3w.b[13][1]++;cov_74t5inh3w.s[23]++;return ruleList.Items;}}// Used to merge new ADR Rules with existing ADR Rules
async saveADRRules(ctx,newADRRules){cov_74t5inh3w.f[4]++;// Check if there are existing ADR rules
let repo=(cov_74t5inh3w.s[24]++,new repositories_1.ADRRuleListRepository(ctx));let existingADRRuleslist=(cov_74t5inh3w.s[25]++,await repo.get());let savedADRRules=(cov_74t5inh3w.s[26]++,[]);cov_74t5inh3w.s[27]++;if((cov_74t5inh3w.b[16][0]++,existingADRRuleslist===undefined)||(cov_74t5inh3w.b[16][1]++,existingADRRuleslist.Items===undefined)||(cov_74t5inh3w.b[16][2]++,existingADRRuleslist.Items.length===0)){cov_74t5inh3w.b[15][0]++;cov_74t5inh3w.s[28]++;//There are no existing ADRRules, create it
console.log('No ADRRules, adding all the provided ADRRules to the ledger');let newADRRuleslist=(cov_74t5inh3w.s[29]++,new models_1.ADRRuleList());cov_74t5inh3w.s[30]++;newADRRuleslist.Items=newADRRules;cov_74t5inh3w.s[31]++;newADRRuleslist=await repo.create(newADRRuleslist);cov_74t5inh3w.s[32]++;savedADRRules=newADRRuleslist.Items;}else{cov_74t5inh3w.b[15][1]++;cov_74t5inh3w.s[33]++;for(let currentADRRule of newADRRules){const existingitemindex=(cov_74t5inh3w.s[34]++,existingADRRuleslist.Items.findIndex((v,i,l)=>{cov_74t5inh3w.f[5]++;cov_74t5inh3w.s[35]++;return currentADRRule.RuleID==v.RuleID;}));cov_74t5inh3w.s[36]++;if(existingitemindex>-1){cov_74t5inh3w.b[17][0]++;cov_74t5inh3w.s[37]++;//Replace existing ADR rule with the matching recieved ADR rule
existingADRRuleslist.Items[existingitemindex]=currentADRRule;cov_74t5inh3w.s[38]++;savedADRRules.push(currentADRRule);}else{cov_74t5inh3w.b[17][1]++;}}// Get a list of ADRRules that are in the new list, but not in the existing list
let newADRRulesNotInExistingList=(cov_74t5inh3w.s[39]++,newADRRules.filter((v,i,l)=>{cov_74t5inh3w.f[6]++;cov_74t5inh3w.s[40]++;return existingADRRuleslist.Items.findIndex((vv,ii,ll)=>{cov_74t5inh3w.f[7]++;cov_74t5inh3w.s[41]++;return v.RuleID==vv.RuleID;})==-1;}));cov_74t5inh3w.s[42]++;if(newADRRulesNotInExistingList.length>0){cov_74t5inh3w.b[18][0]++;cov_74t5inh3w.s[43]++;existingADRRuleslist.Items.push(...newADRRulesNotInExistingList);cov_74t5inh3w.s[44]++;savedADRRules.push(...newADRRulesNotInExistingList);}else{cov_74t5inh3w.b[18][1]++;}cov_74t5inh3w.s[45]++;existingADRRuleslist=await repo.update(existingADRRuleslist);}cov_74t5inh3w.s[46]++;return savedADRRules;}};cov_74t5inh3w.s[47]++;__decorate([fabric_contract_api_1.Transaction(false),fabric_contract_api_1.Returns('ADRRule[]'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context]),__metadata("design:returntype",Promise)],ADRRuleContract.prototype,"retrieveADRRules",null);cov_74t5inh3w.s[48]++;__decorate([fabric_contract_api_1.Transaction(true),fabric_contract_api_1.Param("newADRRules","ADRRUle[]"),fabric_contract_api_1.Returns('UnitOfMeasure[]'),__metadata("design:type",Function),__metadata("design:paramtypes",[fabric_contract_api_1.Context,Array]),__metadata("design:returntype",Promise)],ADRRuleContract.prototype,"saveADRRules",null);cov_74t5inh3w.s[49]++;ADRRuleContract=__decorate([fabric_contract_api_1.Info({title:'ADRRuleContract',description:'Contract for managing the "Automated Dispute Resolution Rule" data for a Vendor'}),__metadata("design:paramtypes",[])],ADRRuleContract);cov_74t5inh3w.s[50]++;exports.ADRRuleContract=ADRRuleContract;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxjb250cmFjdHNcXGFkci1ydWxlLmNvbnRyYWN0LnRzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXFBSQUtBU0hTRUxWQVJBSlxcQmxvY2tjaGFpblxcSG9tZSBEZXBvdFxcRGV2ZWxvcG1lbnRcXGNoYWluY29kZV8wOTAxXFxzcmNcXGNvbnRyYWN0c1xcYWRyLXJ1bGUuY29udHJhY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSw2REFBMkY7QUFDM0Ysc0NBQWlEO0FBQ2pELGtEQUF3RDtBQUt4RCxJQUFhLGVBQWUsR0FBNUIsTUFBYSxlQUFnQixTQUFRLDhCQUFRO0lBR3pDLGdCQUFnQixLQUFLLENBQUMsMkNBQTJDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFLOUQsS0FBSyxDQUFDLGdCQUFnQixDQUFDLEdBQVk7UUFDdEMsSUFBSSxJQUFJLEdBQTBCLElBQUksb0NBQXFCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakUsTUFBTSxRQUFRLEdBQWdCLE1BQU0sSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQy9DLElBQUksUUFBUSxLQUFLLFNBQVMsSUFBSSxRQUFRLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7WUFDdEYsTUFBTSxJQUFJLEtBQUssQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO1NBQ2pGO2FBQU07WUFDSCxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUM7U0FDekI7SUFDTCxDQUFDO0lBR0Qsc0RBQXNEO0lBSS9DLEtBQUssQ0FBQyxZQUFZLENBQUMsR0FBWSxFQUFFLFdBQXNCO1FBQzFELHdDQUF3QztRQUN4QyxJQUFJLElBQUksR0FBMEIsSUFBSSxvQ0FBcUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqRSxJQUFJLG9CQUFvQixHQUFnQixNQUFNLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUV6RCxJQUFJLGFBQWEsR0FBYyxFQUFFLENBQUM7UUFFbEMsSUFBSSxvQkFBb0IsS0FBSyxTQUFTLElBQUksb0JBQW9CLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUMzSCwyQ0FBMkM7WUFDM0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2REFBNkQsQ0FBQyxDQUFDO1lBRTNFLElBQUksZUFBZSxHQUFnQixJQUFJLG9CQUFXLEVBQUUsQ0FBQztZQUNyRCxlQUFlLENBQUMsS0FBSyxHQUFHLFdBQVcsQ0FBQztZQUNwQyxlQUFlLEdBQUcsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ3JELGFBQWEsR0FBRyxlQUFlLENBQUMsS0FBSyxDQUFDO1NBQ3pDO2FBQU07WUFDSCxLQUFLLElBQUksY0FBYyxJQUFJLFdBQVcsRUFBRTtnQkFDcEMsTUFBTSxpQkFBaUIsR0FBRyxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLE9BQU8sY0FBYyxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFBLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBRTFILElBQUksaUJBQWlCLEdBQUcsQ0FBQyxDQUFDLEVBQUU7b0JBQ3hCLCtEQUErRDtvQkFDL0Qsb0JBQW9CLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsY0FBYyxDQUFDO29CQUMvRCxhQUFhLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2lCQUN0QzthQUNKO1lBRUQsZ0ZBQWdGO1lBQ2hGLElBQUksNEJBQTRCLEdBQWMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsR0FBRyxPQUFPLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxPQUFPLENBQUMsQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMzTCxJQUFJLDRCQUE0QixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7Z0JBQ3pDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyw0QkFBNEIsQ0FBQyxDQUFDO2dCQUNqRSxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsNEJBQTRCLENBQUMsQ0FBQTthQUN0RDtZQUVELG9CQUFvQixHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1NBQ2xFO1FBRUQsT0FBTyxhQUFhLENBQUM7SUFDekIsQ0FBQztDQUVKLENBQUE7QUF0REc7SUFGQyxpQ0FBVyxDQUFDLEtBQUssQ0FBQztJQUNsQiw2QkFBTyxDQUFDLFdBQVcsQ0FBQzs7cUNBQ2MsNkJBQU87O3VEQVF6QztBQU9EO0lBSEMsaUNBQVcsQ0FBQyxJQUFJLENBQUM7SUFDakIsMkJBQUssQ0FBQyxhQUFhLEVBQUUsV0FBVyxDQUFDO0lBQ2pDLDZCQUFPLENBQUMsaUJBQWlCLENBQUM7O3FDQUNJLDZCQUFPOzttREFxQ3JDO0FBNURRLGVBQWU7SUFEM0IsMEJBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxXQUFXLEVBQUUsaUZBQWlGLEVBQUUsQ0FBQzs7R0FDdEgsZUFBZSxDQThEM0I7QUE5RFksMENBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZXh0LCBDb250cmFjdCwgSW5mbywgUmV0dXJucywgVHJhbnNhY3Rpb24sIFBhcmFtIH0gZnJvbSAnZmFicmljLWNvbnRyYWN0LWFwaSc7XHJcbmltcG9ydCB7IEFEUlJ1bGUsIEFEUlJ1bGVMaXN0IH0gZnJvbSBcIi4uL21vZGVsc1wiO1xyXG5pbXBvcnQgeyBBRFJSdWxlTGlzdFJlcG9zaXRvcnkgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMnO1xyXG5cclxuXHJcblxyXG5ASW5mbyh7IHRpdGxlOiAnQURSUnVsZUNvbnRyYWN0JywgZGVzY3JpcHRpb246ICdDb250cmFjdCBmb3IgbWFuYWdpbmcgdGhlIFwiQXV0b21hdGVkIERpc3B1dGUgUmVzb2x1dGlvbiBSdWxlXCIgZGF0YSBmb3IgYSBWZW5kb3InIH0pXHJcbmV4cG9ydCBjbGFzcyBBRFJSdWxlQ29udHJhY3QgZXh0ZW5kcyBDb250cmFjdCB7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyBzdXBlcihcImNvbS5ob21lZGVwb3QucHJvY3VyZW1lbnQuQURSUnVsZUNvbnRyYWN0XCIpOyB9XHJcblxyXG5cclxuICAgIEBUcmFuc2FjdGlvbihmYWxzZSlcclxuICAgIEBSZXR1cm5zKCdBRFJSdWxlW10nKVxyXG4gICAgcHVibGljIGFzeW5jIHJldHJpZXZlQURSUnVsZXMoY3R4OiBDb250ZXh0KTogUHJvbWlzZTxBRFJSdWxlW10+IHtcclxuICAgICAgICBsZXQgcmVwbzogQURSUnVsZUxpc3RSZXBvc2l0b3J5ID0gbmV3IEFEUlJ1bGVMaXN0UmVwb3NpdG9yeShjdHgpO1xyXG4gICAgICAgIGNvbnN0IHJ1bGVMaXN0OiBBRFJSdWxlTGlzdCA9IGF3YWl0IHJlcG8uZ2V0KCk7XHJcbiAgICAgICAgaWYgKHJ1bGVMaXN0ID09PSB1bmRlZmluZWQgfHwgcnVsZUxpc3QuSXRlbXMgPT09IHVuZGVmaW5lZCB8fCBydWxlTGlzdC5JdGVtcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVSUk9SOiBObyBBRFJSdWxlcyBleGlzdCBpbiB0aGUgYmxvY2tjaGFpbiBmb3IgdGhpcyBWZW5kb3JgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcnVsZUxpc3QuSXRlbXM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBVc2VkIHRvIG1lcmdlIG5ldyBBRFIgUnVsZXMgd2l0aCBleGlzdGluZyBBRFIgUnVsZXNcclxuICAgIEBUcmFuc2FjdGlvbih0cnVlKVxyXG4gICAgQFBhcmFtKFwibmV3QURSUnVsZXNcIiwgXCJBRFJSVWxlW11cIilcclxuICAgIEBSZXR1cm5zKCdVbml0T2ZNZWFzdXJlW10nKVxyXG4gICAgcHVibGljIGFzeW5jIHNhdmVBRFJSdWxlcyhjdHg6IENvbnRleHQsIG5ld0FEUlJ1bGVzOiBBRFJSdWxlW10pOiBQcm9taXNlPEFEUlJ1bGVbXT4ge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBleGlzdGluZyBBRFIgcnVsZXNcclxuICAgICAgICBsZXQgcmVwbzogQURSUnVsZUxpc3RSZXBvc2l0b3J5ID0gbmV3IEFEUlJ1bGVMaXN0UmVwb3NpdG9yeShjdHgpO1xyXG4gICAgICAgIGxldCBleGlzdGluZ0FEUlJ1bGVzbGlzdDogQURSUnVsZUxpc3QgPSBhd2FpdCByZXBvLmdldCgpO1xyXG5cclxuICAgICAgICBsZXQgc2F2ZWRBRFJSdWxlczogQURSUnVsZVtdID0gW107XHJcblxyXG4gICAgICAgIGlmIChleGlzdGluZ0FEUlJ1bGVzbGlzdCA9PT0gdW5kZWZpbmVkIHx8IGV4aXN0aW5nQURSUnVsZXNsaXN0Lkl0ZW1zID09PSB1bmRlZmluZWQgfHwgZXhpc3RpbmdBRFJSdWxlc2xpc3QuSXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIC8vVGhlcmUgYXJlIG5vIGV4aXN0aW5nIEFEUlJ1bGVzLCBjcmVhdGUgaXRcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIEFEUlJ1bGVzLCBhZGRpbmcgYWxsIHRoZSBwcm92aWRlZCBBRFJSdWxlcyB0byB0aGUgbGVkZ2VyJyk7XHJcblxyXG4gICAgICAgICAgICBsZXQgbmV3QURSUnVsZXNsaXN0OiBBRFJSdWxlTGlzdCA9IG5ldyBBRFJSdWxlTGlzdCgpO1xyXG4gICAgICAgICAgICBuZXdBRFJSdWxlc2xpc3QuSXRlbXMgPSBuZXdBRFJSdWxlcztcclxuICAgICAgICAgICAgbmV3QURSUnVsZXNsaXN0ID0gYXdhaXQgcmVwby5jcmVhdGUobmV3QURSUnVsZXNsaXN0KTtcclxuICAgICAgICAgICAgc2F2ZWRBRFJSdWxlcyA9IG5ld0FEUlJ1bGVzbGlzdC5JdGVtcztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjdXJyZW50QURSUnVsZSBvZiBuZXdBRFJSdWxlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdpdGVtaW5kZXggPSBleGlzdGluZ0FEUlJ1bGVzbGlzdC5JdGVtcy5maW5kSW5kZXgoKHYsIGksIGwpID0+IHsgcmV0dXJuIGN1cnJlbnRBRFJSdWxlLlJ1bGVJRCA9PSB2LlJ1bGVJRCB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdpdGVtaW5kZXggPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vUmVwbGFjZSBleGlzdGluZyBBRFIgcnVsZSB3aXRoIHRoZSBtYXRjaGluZyByZWNpZXZlZCBBRFIgcnVsZVxyXG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nQURSUnVsZXNsaXN0Lkl0ZW1zW2V4aXN0aW5naXRlbWluZGV4XSA9IGN1cnJlbnRBRFJSdWxlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNhdmVkQURSUnVsZXMucHVzaChjdXJyZW50QURSUnVsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEdldCBhIGxpc3Qgb2YgQURSUnVsZXMgdGhhdCBhcmUgaW4gdGhlIG5ldyBsaXN0LCBidXQgbm90IGluIHRoZSBleGlzdGluZyBsaXN0XHJcbiAgICAgICAgICAgIGxldCBuZXdBRFJSdWxlc05vdEluRXhpc3RpbmdMaXN0OiBBRFJSdWxlW10gPSBuZXdBRFJSdWxlcy5maWx0ZXIoKHYsIGksIGwpID0+IHsgcmV0dXJuIChleGlzdGluZ0FEUlJ1bGVzbGlzdC5JdGVtcy5maW5kSW5kZXgoKHZ2LCBpaSwgbGwpID0+IHsgcmV0dXJuIHYuUnVsZUlEID09IHZ2LlJ1bGVJRDsgfSkgPT0gLTEpOyB9KTtcclxuICAgICAgICAgICAgaWYgKG5ld0FEUlJ1bGVzTm90SW5FeGlzdGluZ0xpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZXhpc3RpbmdBRFJSdWxlc2xpc3QuSXRlbXMucHVzaCguLi5uZXdBRFJSdWxlc05vdEluRXhpc3RpbmdMaXN0KTtcclxuICAgICAgICAgICAgICAgIHNhdmVkQURSUnVsZXMucHVzaCguLi5uZXdBRFJSdWxlc05vdEluRXhpc3RpbmdMaXN0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGlzdGluZ0FEUlJ1bGVzbGlzdCA9IGF3YWl0IHJlcG8udXBkYXRlKGV4aXN0aW5nQURSUnVsZXNsaXN0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzYXZlZEFEUlJ1bGVzO1xyXG4gICAgfVxyXG5cclxufSJdfQ==