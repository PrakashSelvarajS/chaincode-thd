"use strict";var cov_2kzet1l9se=function(){var path="C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\decorators\\property-validator.decorator.ts";var hash="3d69215b75e439879451f58f20f4de50cf0ee3ec";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\PRAKASHSELVARAJ\\Blockchain\\Home Depot\\Development\\chaincode_0901\\src\\decorators\\property-validator.decorator.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:15},end:{line:3,column:35}},"2":{start:{line:4,column:15},end:{line:4,column:79}},"3":{start:{line:5,column:0},end:{line:5,column:28}},"4":{start:{line:6,column:31},end:{line:6,column:44}},"5":{start:{line:8,column:4},end:{line:30,column:6}},"6":{start:{line:9,column:8},end:{line:9,column:76}},"7":{start:{line:10,column:8},end:{line:29,column:10}},"8":{start:{line:11,column:29},end:{line:11,column:31}},"9":{start:{line:13,column:41},end:{line:13,column:73}},"10":{start:{line:14,column:12},end:{line:17,column:15}},"11":{start:{line:16,column:16},end:{line:16,column:40}},"12":{start:{line:19,column:24},end:{line:19,column:73}},"13":{start:{line:20,column:26},end:{line:20,column:42}},"14":{start:{line:21,column:12},end:{line:28,column:27}},"15":{start:{line:22,column:16},end:{line:24,column:17}},"16":{start:{line:22,column:67},end:{line:22,column:83}},"17":{start:{line:23,column:20},end:{line:23,column:36}},"18":{start:{line:26,column:16},end:{line:26,column:47}},"19":{start:{line:27,column:16},end:{line:27,column:32}},"20":{start:{line:32,column:0},end:{line:32,column:42}},"21":{start:{line:33,column:30},end:{line:33,column:39}},"22":{start:{line:35,column:4},end:{line:35,column:57}},"23":{start:{line:36,column:4},end:{line:36,column:57}},"24":{start:{line:37,column:4},end:{line:41,column:7}},"25":{start:{line:38,column:8},end:{line:38,column:46}},"26":{start:{line:39,column:8},end:{line:39,column:53}},"27":{start:{line:40,column:8},end:{line:40,column:62}},"28":{start:{line:42,column:4},end:{line:42,column:57}},"29":{start:{line:44,column:0},end:{line:44,column:52}},"30":{start:{line:46,column:4},end:{line:94,column:6}},"31":{start:{line:47,column:8},end:{line:47,column:124}},"32":{start:{line:48,column:8},end:{line:50,column:9}},"33":{start:{line:49,column:12},end:{line:49,column:58}},"34":{start:{line:51,column:8},end:{line:53,column:9}},"35":{start:{line:52,column:12},end:{line:52,column:53}},"36":{start:{line:55,column:20},end:{line:55,column:74}},"37":{start:{line:56,column:18},end:{line:56,column:52}},"38":{start:{line:57,column:8},end:{line:60,column:9}},"39":{start:{line:58,column:12},end:{line:58,column:21}},"40":{start:{line:59,column:12},end:{line:59,column:52}},"41":{start:{line:61,column:8},end:{line:61,column:39}},"42":{start:{line:63,column:8},end:{line:63,column:44}},"43":{start:{line:66,column:32},end:{line:73,column:9}},"44":{start:{line:68,column:34},end:{line:68,column:60}},"45":{start:{line:69,column:33},end:{line:69,column:149}},"46":{start:{line:70,column:33},end:{line:70,column:144}},"47":{start:{line:71,column:12},end:{line:71,column:130}},"48":{start:{line:72,column:12},end:{line:72,column:90}},"49":{start:{line:75,column:40},end:{line:75,column:48}},"50":{start:{line:77,column:8},end:{line:93,column:10}},"51":{start:{line:80,column:16},end:{line:80,column:53}},"52":{start:{line:84,column:16},end:{line:86,column:17}},"53":{start:{line:85,column:20},end:{line:85,column:111}},"54":{start:{line:87,column:16},end:{line:89,column:17}},"55":{start:{line:88,column:20},end:{line:88,column:140}},"56":{start:{line:91,column:16},end:{line:91,column:65}},"57":{start:{line:96,column:0},end:{line:96,column:52}},"58":{start:{line:98,column:4},end:{line:164,column:6}},"59":{start:{line:99,column:8},end:{line:99,column:117}},"60":{start:{line:100,column:8},end:{line:102,column:9}},"61":{start:{line:101,column:12},end:{line:101,column:37}},"62":{start:{line:103,column:8},end:{line:105,column:9}},"63":{start:{line:104,column:12},end:{line:104,column:59}},"64":{start:{line:106,column:8},end:{line:108,column:9}},"65":{start:{line:107,column:12},end:{line:107,column:45}},"66":{start:{line:109,column:8},end:{line:111,column:9}},"67":{start:{line:110,column:12},end:{line:110,column:46}},"68":{start:{line:112,column:8},end:{line:114,column:9}},"69":{start:{line:113,column:12},end:{line:113,column:61}},"70":{start:{line:116,column:20},end:{line:116,column:74}},"71":{start:{line:117,column:18},end:{line:117,column:52}},"72":{start:{line:118,column:8},end:{line:121,column:9}},"73":{start:{line:119,column:12},end:{line:119,column:21}},"74":{start:{line:120,column:12},end:{line:120,column:52}},"75":{start:{line:122,column:8},end:{line:122,column:39}},"76":{start:{line:124,column:8},end:{line:124,column:44}},"77":{start:{line:126,column:28},end:{line:146,column:9}},"78":{start:{line:128,column:34},end:{line:128,column:60}},"79":{start:{line:129,column:12},end:{line:131,column:13}},"80":{start:{line:130,column:16},end:{line:130,column:29}},"81":{start:{line:132,column:12},end:{line:134,column:13}},"82":{start:{line:133,column:16},end:{line:133,column:29}},"83":{start:{line:135,column:12},end:{line:137,column:13}},"84":{start:{line:136,column:16},end:{line:136,column:29}},"85":{start:{line:138,column:12},end:{line:140,column:13}},"86":{start:{line:139,column:16},end:{line:139,column:29}},"87":{start:{line:141,column:12},end:{line:143,column:13}},"88":{start:{line:142,column:16},end:{line:142,column:29}},"89":{start:{line:144,column:12},end:{line:144,column:331}},"90":{start:{line:145,column:12},end:{line:145,column:24}},"91":{start:{line:148,column:40},end:{line:148,column:48}},"92":{start:{line:150,column:8},end:{line:163,column:10}},"93":{start:{line:153,column:16},end:{line:153,column:53}},"94":{start:{line:157,column:16},end:{line:159,column:17}},"95":{start:{line:158,column:20},end:{line:158,column:132}},"96":{start:{line:161,column:16},end:{line:161,column:65}},"97":{start:{line:166,column:0},end:{line:166,column:38}}},fnMap:{"0":{name:"ValidatedObject",decl:{start:{line:7,column:9},end:{line:7,column:24}},loc:{start:{line:7,column:27},end:{line:31,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:11},end:{line:8,column:12}},loc:{start:{line:8,column:28},end:{line:30,column:5}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:10,column:39},end:{line:10,column:40}},loc:{start:{line:10,column:51},end:{line:29,column:9}},line:10},"3":{name:"(anonymous_3)",decl:{start:{line:14,column:41},end:{line:14,column:42}},loc:{start:{line:14,column:54},end:{line:17,column:13}},line:14},"4":{name:"(anonymous_4)",decl:{start:{line:21,column:32},end:{line:21,column:33}},loc:{start:{line:21,column:51},end:{line:28,column:13}},line:21},"5":{name:"(anonymous_5)",decl:{start:{line:22,column:52},end:{line:22,column:53}},loc:{start:{line:22,column:65},end:{line:22,column:85}},line:22},"6":{name:"ListValidatorConfigs",decl:{start:{line:34,column:9},end:{line:34,column:29}},loc:{start:{line:34,column:32},end:{line:43,column:1}},line:34},"7":{name:"(anonymous_7)",decl:{start:{line:37,column:34},end:{line:37,column:35}},loc:{start:{line:37,column:47},end:{line:41,column:5}},line:37},"8":{name:"NumberRangeValidator",decl:{start:{line:45,column:9},end:{line:45,column:29}},loc:{start:{line:45,column:38},end:{line:95,column:1}},line:45},"9":{name:"(anonymous_9)",decl:{start:{line:46,column:11},end:{line:46,column:12}},loc:{start:{line:46,column:36},end:{line:94,column:5}},line:46},"10":{name:"(anonymous_10)",decl:{start:{line:66,column:32},end:{line:66,column:33}},loc:{start:{line:66,column:54},end:{line:73,column:9}},line:66},"11":{name:"(anonymous_11)",decl:{start:{line:78,column:12},end:{line:78,column:13}},loc:{start:{line:78,column:18},end:{line:81,column:13}},line:78},"12":{name:"(anonymous_12)",decl:{start:{line:82,column:12},end:{line:82,column:13}},loc:{start:{line:82,column:34},end:{line:92,column:13}},line:82},"13":{name:"TextValidator",decl:{start:{line:97,column:9},end:{line:97,column:22}},loc:{start:{line:97,column:31},end:{line:165,column:1}},line:97},"14":{name:"(anonymous_14)",decl:{start:{line:98,column:11},end:{line:98,column:12}},loc:{start:{line:98,column:36},end:{line:164,column:5}},line:98},"15":{name:"(anonymous_15)",decl:{start:{line:126,column:28},end:{line:126,column:29}},loc:{start:{line:126,column:50},end:{line:146,column:9}},line:126},"16":{name:"(anonymous_16)",decl:{start:{line:151,column:12},end:{line:151,column:13}},loc:{start:{line:151,column:18},end:{line:154,column:13}},line:151},"17":{name:"(anonymous_17)",decl:{start:{line:155,column:12},end:{line:155,column:13}},loc:{start:{line:155,column:34},end:{line:162,column:13}},line:155}},branchMap:{"0":{loc:{start:{line:22,column:16},end:{line:24,column:17}},type:"if",locations:[{start:{line:22,column:16},end:{line:24,column:17}},{start:{line:22,column:16},end:{line:24,column:17}}],line:22},"1":{loc:{start:{line:48,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:48,column:8},end:{line:50,column:9}},{start:{line:48,column:8},end:{line:50,column:9}}],line:48},"2":{loc:{start:{line:51,column:8},end:{line:53,column:9}},type:"if",locations:[{start:{line:51,column:8},end:{line:53,column:9}},{start:{line:51,column:8},end:{line:53,column:9}}],line:51},"3":{loc:{start:{line:57,column:8},end:{line:60,column:9}},type:"if",locations:[{start:{line:57,column:8},end:{line:60,column:9}},{start:{line:57,column:8},end:{line:60,column:9}}],line:57},"4":{loc:{start:{line:69,column:33},end:{line:69,column:149}},type:"cond-expr",locations:[{start:{line:69,column:104},end:{line:69,column:125}},{start:{line:69,column:128},end:{line:69,column:149}}],line:69},"5":{loc:{start:{line:69,column:34},end:{line:69,column:100}},type:"binary-expr",locations:[{start:{line:69,column:34},end:{line:69,column:61}},{start:{line:69,column:65},end:{line:69,column:100}}],line:69},"6":{loc:{start:{line:70,column:33},end:{line:70,column:144}},type:"cond-expr",locations:[{start:{line:70,column:104},end:{line:70,column:120}},{start:{line:70,column:123},end:{line:70,column:144}}],line:70},"7":{loc:{start:{line:70,column:34},end:{line:70,column:100}},type:"binary-expr",locations:[{start:{line:70,column:34},end:{line:70,column:61}},{start:{line:70,column:65},end:{line:70,column:100}}],line:70},"8":{loc:{start:{line:72,column:20},end:{line:72,column:88}},type:"binary-expr",locations:[{start:{line:72,column:20},end:{line:72,column:52}},{start:{line:72,column:56},end:{line:72,column:88}}],line:72},"9":{loc:{start:{line:84,column:16},end:{line:86,column:17}},type:"if",locations:[{start:{line:84,column:16},end:{line:86,column:17}},{start:{line:84,column:16},end:{line:86,column:17}}],line:84},"10":{loc:{start:{line:87,column:16},end:{line:89,column:17}},type:"if",locations:[{start:{line:87,column:16},end:{line:89,column:17}},{start:{line:87,column:16},end:{line:89,column:17}}],line:87},"11":{loc:{start:{line:100,column:8},end:{line:102,column:9}},type:"if",locations:[{start:{line:100,column:8},end:{line:102,column:9}},{start:{line:100,column:8},end:{line:102,column:9}}],line:100},"12":{loc:{start:{line:103,column:8},end:{line:105,column:9}},type:"if",locations:[{start:{line:103,column:8},end:{line:105,column:9}},{start:{line:103,column:8},end:{line:105,column:9}}],line:103},"13":{loc:{start:{line:106,column:8},end:{line:108,column:9}},type:"if",locations:[{start:{line:106,column:8},end:{line:108,column:9}},{start:{line:106,column:8},end:{line:108,column:9}}],line:106},"14":{loc:{start:{line:109,column:8},end:{line:111,column:9}},type:"if",locations:[{start:{line:109,column:8},end:{line:111,column:9}},{start:{line:109,column:8},end:{line:111,column:9}}],line:109},"15":{loc:{start:{line:112,column:8},end:{line:114,column:9}},type:"if",locations:[{start:{line:112,column:8},end:{line:114,column:9}},{start:{line:112,column:8},end:{line:114,column:9}}],line:112},"16":{loc:{start:{line:118,column:8},end:{line:121,column:9}},type:"if",locations:[{start:{line:118,column:8},end:{line:121,column:9}},{start:{line:118,column:8},end:{line:121,column:9}}],line:118},"17":{loc:{start:{line:129,column:12},end:{line:131,column:13}},type:"if",locations:[{start:{line:129,column:12},end:{line:131,column:13}},{start:{line:129,column:12},end:{line:131,column:13}}],line:129},"18":{loc:{start:{line:129,column:16},end:{line:129,column:94}},type:"binary-expr",locations:[{start:{line:129,column:16},end:{line:129,column:58}},{start:{line:129,column:62},end:{line:129,column:94}}],line:129},"19":{loc:{start:{line:132,column:12},end:{line:134,column:13}},type:"if",locations:[{start:{line:132,column:12},end:{line:134,column:13}},{start:{line:132,column:12},end:{line:134,column:13}}],line:132},"20":{loc:{start:{line:132,column:16},end:{line:132,column:93}},type:"binary-expr",locations:[{start:{line:132,column:16},end:{line:132,column:59}},{start:{line:132,column:63},end:{line:132,column:93}}],line:132},"21":{loc:{start:{line:135,column:12},end:{line:137,column:13}},type:"if",locations:[{start:{line:135,column:12},end:{line:137,column:13}},{start:{line:135,column:12},end:{line:137,column:13}}],line:135},"22":{loc:{start:{line:135,column:16},end:{line:135,column:104}},type:"binary-expr",locations:[{start:{line:135,column:16},end:{line:135,column:47}},{start:{line:135,column:51},end:{line:135,column:104}}],line:135},"23":{loc:{start:{line:138,column:12},end:{line:140,column:13}},type:"if",locations:[{start:{line:138,column:12},end:{line:140,column:13}},{start:{line:138,column:12},end:{line:140,column:13}}],line:138},"24":{loc:{start:{line:138,column:16},end:{line:138,column:104}},type:"binary-expr",locations:[{start:{line:138,column:16},end:{line:138,column:47}},{start:{line:138,column:51},end:{line:138,column:104}}],line:138},"25":{loc:{start:{line:141,column:12},end:{line:143,column:13}},type:"if",locations:[{start:{line:141,column:12},end:{line:143,column:13}},{start:{line:141,column:12},end:{line:143,column:13}}],line:141},"26":{loc:{start:{line:157,column:16},end:{line:159,column:17}},type:"if",locations:[{start:{line:157,column:16},end:{line:159,column:17}},{start:{line:157,column:16},end:{line:159,column:17}}],line:157}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"3d69215b75e439879451f58f20f4de50cf0ee3ec"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();cov_2kzet1l9se.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const Logger=(cov_2kzet1l9se.s[1]++,require('../logger'));const logger=(cov_2kzet1l9se.s[2]++,Logger.getLogger('./decorators/property-validator.decorator.ts'));cov_2kzet1l9se.s[3]++;require("reflect-metadata");const objectSerializationMap=(cov_2kzet1l9se.s[4]++,new WeakMap());function ValidatedObject(){cov_2kzet1l9se.f[0]++;cov_2kzet1l9se.s[5]++;return constructor=>{cov_2kzet1l9se.f[1]++;cov_2kzet1l9se.s[6]++;logger.debug('@ValidatedObject args: Target ->'+constructor.name);cov_2kzet1l9se.s[7]++;constructor.prototype.toJSON=function(){cov_2kzet1l9se.f[2]++;let jsonResult=(cov_2kzet1l9se.s[8]++,{});// First, we want to serialize all the basic properties for this instance
const instancePropertyKeys=(cov_2kzet1l9se.s[9]++,Object.getOwnPropertyNames(this));cov_2kzet1l9se.s[10]++;instancePropertyKeys.forEach((v,i,l)=>{cov_2kzet1l9se.f[3]++;cov_2kzet1l9se.s[11]++;//@ts-ignore
jsonResult[v]=this[v];});// Then add all the properties that have Validators attached to them
const map=(cov_2kzet1l9se.s[12]++,objectSerializationMap.get(constructor.prototype));const props=(cov_2kzet1l9se.s[13]++,Object.keys(map));cov_2kzet1l9se.s[14]++;return props.reduce((previous,key)=>{cov_2kzet1l9se.f[4]++;cov_2kzet1l9se.s[15]++;if(Object.keys(previous).findIndex((v,i,l)=>{cov_2kzet1l9se.f[5]++;cov_2kzet1l9se.s[16]++;return v==key;})>-1){cov_2kzet1l9se.b[0][0]++;cov_2kzet1l9se.s[17]++;return previous;}else{cov_2kzet1l9se.b[0][1]++;}//@ts-ignore
cov_2kzet1l9se.s[18]++;previous[map[key]]=this[key];cov_2kzet1l9se.s[19]++;return previous;},jsonResult);};};}cov_2kzet1l9se.s[20]++;exports.ValidatedObject=ValidatedObject;const ALL_VALIDATOR_CONFIGS=(cov_2kzet1l9se.s[21]++,new Map());function ListValidatorConfigs(){cov_2kzet1l9se.f[6]++;cov_2kzet1l9se.s[22]++;logger.debug('LIST OF ALL VALIDATOR CONFIGURATIONS');cov_2kzet1l9se.s[23]++;logger.debug('====================================');cov_2kzet1l9se.s[24]++;ALL_VALIDATOR_CONFIGS.forEach((v,k,m)=>{cov_2kzet1l9se.f[7]++;cov_2kzet1l9se.s[25]++;logger.debug('Key = '+k.toString());cov_2kzet1l9se.s[26]++;logger.debug('Value = '+JSON.stringify(v));cov_2kzet1l9se.s[27]++;logger.debug('-------------------------------------');});cov_2kzet1l9se.s[28]++;logger.debug('====================================');}cov_2kzet1l9se.s[29]++;exports.ListValidatorConfigs=ListValidatorConfigs;function NumberRangeValidator(config){cov_2kzet1l9se.f[8]++;cov_2kzet1l9se.s[30]++;return(target,propertyKey)=>{cov_2kzet1l9se.f[9]++;cov_2kzet1l9se.s[31]++;logger.debug('@NumberRangeValidator args:',`target -> ${target.constructor.name},`,'propertyKey ->',propertyKey);cov_2kzet1l9se.s[32]++;if(config.defaultMinimum===undefined){cov_2kzet1l9se.b[1][0]++;cov_2kzet1l9se.s[33]++;config.defaultMinimum=-1*Number.MAX_VALUE;}else{cov_2kzet1l9se.b[1][1]++;}cov_2kzet1l9se.s[34]++;if(config.defaultMaximum===undefined){cov_2kzet1l9se.b[2][0]++;cov_2kzet1l9se.s[35]++;config.defaultMaximum=Number.MAX_VALUE;}else{cov_2kzet1l9se.b[2][1]++;}// Create a key for storing the config for this instance using the target name and the propertyKey
const key=(cov_2kzet1l9se.s[36]++,target.constructor.name+'-'+propertyKey.toString());let map=(cov_2kzet1l9se.s[37]++,objectSerializationMap.get(target));cov_2kzet1l9se.s[38]++;if(!map){cov_2kzet1l9se.b[3][0]++;cov_2kzet1l9se.s[39]++;map={};cov_2kzet1l9se.s[40]++;objectSerializationMap.set(target,map);}else{cov_2kzet1l9se.b[3][1]++;}cov_2kzet1l9se.s[41]++;map[propertyKey]=propertyKey;// Store the config for this instance
cov_2kzet1l9se.s[42]++;ALL_VALIDATOR_CONFIGS[key]=config;//ListValidatorConfigs();
// Create the range validator using the config
cov_2kzet1l9se.s[43]++;const numberIsInRange=newPropertyValue=>{cov_2kzet1l9se.f[10]++;// Retrieve the config from storage
const currentConfig=(cov_2kzet1l9se.s[44]++,ALL_VALIDATOR_CONFIGS[key]);const rangeMinimum=(cov_2kzet1l9se.s[45]++,(cov_2kzet1l9se.b[5][0]++,currentConfig===undefined)||(cov_2kzet1l9se.b[5][1]++,currentConfig.minimum===undefined)?(cov_2kzet1l9se.b[4][0]++,-1*Number.MAX_VALUE):(cov_2kzet1l9se.b[4][1]++,currentConfig.minimum));const rangeMaximum=(cov_2kzet1l9se.s[46]++,(cov_2kzet1l9se.b[7][0]++,currentConfig===undefined)||(cov_2kzet1l9se.b[7][1]++,currentConfig.maximum===undefined)?(cov_2kzet1l9se.b[6][0]++,Number.MAX_VALUE):(cov_2kzet1l9se.b[6][1]++,currentConfig.maximum));cov_2kzet1l9se.s[47]++;logger.debug('numberIsInRange : value = '+newPropertyValue+', min = '+rangeMinimum+', max = '+rangeMaximum);cov_2kzet1l9se.s[48]++;return(cov_2kzet1l9se.b[8][0]++,newPropertyValue>=rangeMinimum)&&(cov_2kzet1l9se.b[8][1]++,newPropertyValue<=rangeMaximum);};// We need a unique key for storing the property value
const propertyValueStorageKey=(cov_2kzet1l9se.s[49]++,Symbol());// We can return a property descriptor that is used to define a property on the target given the `propertyKey`.
cov_2kzet1l9se.s[50]++;return{get(){cov_2kzet1l9se.f[11]++;cov_2kzet1l9se.s[51]++;// Read the value from the target instance using the unique symbol from above
return this[propertyValueStorageKey];},set(newPropertyValue){cov_2kzet1l9se.f[12]++;cov_2kzet1l9se.s[52]++;// Retrieve the config from storage
if(Number.isNaN(newPropertyValue)){cov_2kzet1l9se.b[9][0]++;cov_2kzet1l9se.s[53]++;throw new Error(`Property value provided for ${key} is not a number: ${newPropertyValue}`);}else{cov_2kzet1l9se.b[9][1]++;}cov_2kzet1l9se.s[54]++;if(!numberIsInRange(newPropertyValue)){cov_2kzet1l9se.b[10][0]++;cov_2kzet1l9se.s[55]++;throw new Error(`Property value provided for ${key} is not in the valid range: ${newPropertyValue}, config: ${config}`);}else{cov_2kzet1l9se.b[10][1]++;}// Save this new value because it is valid
cov_2kzet1l9se.s[56]++;this[propertyValueStorageKey]=newPropertyValue;}};};}cov_2kzet1l9se.s[57]++;exports.NumberRangeValidator=NumberRangeValidator;function TextValidator(config){cov_2kzet1l9se.f[13]++;cov_2kzet1l9se.s[58]++;return(target,propertyKey)=>{cov_2kzet1l9se.f[14]++;cov_2kzet1l9se.s[59]++;logger.debug('@TextValidator args:',`target -> ${target.constructor.name},`,'propertyKey ->',propertyKey);cov_2kzet1l9se.s[60]++;if(config.minimumLength===undefined){cov_2kzet1l9se.b[11][0]++;cov_2kzet1l9se.s[61]++;config.minimumLength=0;}else{cov_2kzet1l9se.b[11][1]++;}cov_2kzet1l9se.s[62]++;if(config.maximumLength===undefined){cov_2kzet1l9se.b[12][0]++;cov_2kzet1l9se.s[63]++;config.maximumLength=Number.MAX_SAFE_INTEGER;}else{cov_2kzet1l9se.b[12][1]++;}cov_2kzet1l9se.s[64]++;if(config.allowLeadingSpaces===undefined){cov_2kzet1l9se.b[13][0]++;cov_2kzet1l9se.s[65]++;config.allowLeadingSpaces=true;}else{cov_2kzet1l9se.b[13][1]++;}cov_2kzet1l9se.s[66]++;if(config.allowTrailingSpaces===undefined){cov_2kzet1l9se.b[14][0]++;cov_2kzet1l9se.s[67]++;config.allowTrailingSpaces=true;}else{cov_2kzet1l9se.b[14][1]++;}cov_2kzet1l9se.s[68]++;if(config.characterSetRegularExpression===undefined){cov_2kzet1l9se.b[15][0]++;cov_2kzet1l9se.s[69]++;config.characterSetRegularExpression=/[\s\S]*/;}else{cov_2kzet1l9se.b[15][1]++;}// Create a key for storing the config for this instance using the target name and the propertyKey
const key=(cov_2kzet1l9se.s[70]++,target.constructor.name+'-'+propertyKey.toString());let map=(cov_2kzet1l9se.s[71]++,objectSerializationMap.get(target));cov_2kzet1l9se.s[72]++;if(!map){cov_2kzet1l9se.b[16][0]++;cov_2kzet1l9se.s[73]++;map={};cov_2kzet1l9se.s[74]++;objectSerializationMap.set(target,map);}else{cov_2kzet1l9se.b[16][1]++;}cov_2kzet1l9se.s[75]++;map[propertyKey]=propertyKey;// Store the config for this instance
cov_2kzet1l9se.s[76]++;ALL_VALIDATOR_CONFIGS[key]=config;// Create the text validator using the config
cov_2kzet1l9se.s[77]++;const textIsValid=newPropertyValue=>{cov_2kzet1l9se.f[15]++;// Retrieve the config from storage
const currentConfig=(cov_2kzet1l9se.s[78]++,ALL_VALIDATOR_CONFIGS[key]);cov_2kzet1l9se.s[79]++;if((cov_2kzet1l9se.b[18][0]++,currentConfig.allowLeadingSpaces===false)&&(cov_2kzet1l9se.b[18][1]++,newPropertyValue.startsWith(' '))){cov_2kzet1l9se.b[17][0]++;cov_2kzet1l9se.s[80]++;return false;}else{cov_2kzet1l9se.b[17][1]++;}cov_2kzet1l9se.s[81]++;if((cov_2kzet1l9se.b[20][0]++,currentConfig.allowTrailingSpaces===false)&&(cov_2kzet1l9se.b[20][1]++,newPropertyValue.endsWith(' '))){cov_2kzet1l9se.b[19][0]++;cov_2kzet1l9se.s[82]++;return false;}else{cov_2kzet1l9se.b[19][1]++;}cov_2kzet1l9se.s[83]++;if((cov_2kzet1l9se.b[22][0]++,currentConfig.minimumLength>0)&&(cov_2kzet1l9se.b[22][1]++,newPropertyValue.length<currentConfig.minimumLength)){cov_2kzet1l9se.b[21][0]++;cov_2kzet1l9se.s[84]++;return false;}else{cov_2kzet1l9se.b[21][1]++;}cov_2kzet1l9se.s[85]++;if((cov_2kzet1l9se.b[24][0]++,currentConfig.maximumLength>0)&&(cov_2kzet1l9se.b[24][1]++,newPropertyValue.length>currentConfig.maximumLength)){cov_2kzet1l9se.b[23][0]++;cov_2kzet1l9se.s[86]++;return false;}else{cov_2kzet1l9se.b[23][1]++;}cov_2kzet1l9se.s[87]++;if(currentConfig.characterSetRegularExpression.exec(newPropertyValue).length!==1){cov_2kzet1l9se.b[25][0]++;cov_2kzet1l9se.s[88]++;return false;}else{cov_2kzet1l9se.b[25][1]++;}cov_2kzet1l9se.s[89]++;logger.debug(`textIsValid : value = '${newPropertyValue}', min = ${currentConfig.minimumLength}, max = ${currentConfig.maximumLength}, leadingSpaces = ${currentConfig.allowLeadingSpaces}, trailingSpaces = ${currentConfig.allowTrailingSpaces}, characterSetRegex = ${currentConfig.characterSetRegularExpression.source}`);cov_2kzet1l9se.s[90]++;return true;};// We need a unique key for storing the property value
const propertyValueStorageKey=(cov_2kzet1l9se.s[91]++,Symbol());// We can return a property descriptor that is used to define a property on the target given the `propertyKey`.
cov_2kzet1l9se.s[92]++;return{get(){cov_2kzet1l9se.f[16]++;cov_2kzet1l9se.s[93]++;// Read the value from the target instance using the unique symbol from above
return this[propertyValueStorageKey];},set(newPropertyValue){cov_2kzet1l9se.f[17]++;cov_2kzet1l9se.s[94]++;// Retrieve the config from storage
if(!textIsValid(newPropertyValue)){cov_2kzet1l9se.b[26][0]++;cov_2kzet1l9se.s[95]++;throw new Error(`Property value provided for ${key} is not valid text: ${newPropertyValue}, config: ${config}`);}else{cov_2kzet1l9se.b[26][1]++;}// Save this new value because it is valid
cov_2kzet1l9se.s[96]++;this[propertyValueStorageKey]=newPropertyValue;}};};}cov_2kzet1l9se.s[97]++;exports.TextValidator=TextValidator;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzpcXFVzZXJzXFxQUkFLQVNIU0VMVkFSQUpcXEJsb2NrY2hhaW5cXEhvbWUgRGVwb3RcXERldmVsb3BtZW50XFxjaGFpbmNvZGVfMDkwMVxcc3JjXFxkZWNvcmF0b3JzXFxwcm9wZXJ0eS12YWxpZGF0b3IuZGVjb3JhdG9yLnRzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXFBSQUtBU0hTRUxWQVJBSlxcQmxvY2tjaGFpblxcSG9tZSBEZXBvdFxcRGV2ZWxvcG1lbnRcXGNoYWluY29kZV8wOTAxXFxzcmNcXGRlY29yYXRvcnNcXHByb3BlcnR5LXZhbGlkYXRvci5kZWNvcmF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDcEMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO0FBQ2hGLDRCQUEwQjtBQUcxQixNQUFNLHNCQUFzQixHQUFHLElBQUksT0FBTyxFQUFFLENBQUM7QUFFN0MsU0FBZ0IsZUFBZTtJQUMzQixPQUFPLENBQUMsV0FBc0IsRUFBRSxFQUFFO1FBQzlCLE1BQU0sQ0FBQyxLQUFLLENBQUMsa0NBQWtDLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BFLFdBQVcsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHO1lBQzNCLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUNwQix5RUFBeUU7WUFDekUsTUFBTSxvQkFBb0IsR0FBYyxNQUFNLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDekUsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUMsRUFBRTtnQkFDcEMsWUFBWTtnQkFDWixVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzFCLENBQUMsQ0FBQyxDQUFDO1lBRUgsb0VBQW9F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QUFnQixDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtnQkFBRSxPQUFPLEtBQUssQ0FBQzthQUFFO1lBRXZHLE1BQU0sQ0FBQyxLQUFLLENBQUMsMEJBQTBCLGdCQUFnQixZQUFZLGFBQWEsQ0FBQyxhQUFhLFdBQVcsYUFBYSxDQUFDLGFBQWEscUJBQXFCLGFBQWEsQ0FBQyxrQkFBa0Isc0JBQXNCLGFBQWEsQ0FBQyxtQkFBbUIseUJBQXlCLGFBQWEsQ0FBQyw2QkFBNkIsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO1lBRS9ULE9BQU8sSUFBSSxDQUFDO1FBQ2hCLENBQUMsQ0FBQztRQUVGLHNEQUFzRDtRQUN0RCxNQUFNLHVCQUF1QixHQUFHLE1BQU0sRUFBRSxDQUFDO1FBRXpDLCtHQUErRztRQUMvRyxPQUFPO1lBQ0gsR0FBRztnQkFDQyw2RUFBNkU7Z0JBQzdFLE9BQU8sSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFDekMsQ0FBQztZQUNELEdBQUcsQ0FBQyxnQkFBcUI7Z0JBQ3JCLG1DQUFtQztnQkFDbkMsSUFBSyxDQUFFLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO29CQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLEdBQUcsdUJBQXVCLGdCQUFnQixhQUFhLE1BQU0sRUFBRSxDQUFDLENBQUM7aUJBQUU7Z0JBRTFKLDBDQUEwQztnQkFDMUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLEdBQUcsZ0JBQWdCLENBQUM7WUFDckQsQ0FBQztTQUNKLENBQUE7SUFDTCxDQUFDLENBQUE7QUFDTCxDQUFDO0FBekRELHNDQXlEQyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuY29uc3QgTG9nZ2VyID0gcmVxdWlyZSgnLi4vbG9nZ2VyJyk7XHJcbmNvbnN0IGxvZ2dlciA9IExvZ2dlci5nZXRMb2dnZXIoJy4vZGVjb3JhdG9ycy9wcm9wZXJ0eS12YWxpZGF0b3IuZGVjb3JhdG9yLnRzJyk7XHJcbmltcG9ydCAncmVmbGVjdC1tZXRhZGF0YSc7XHJcblxyXG5cclxuY29uc3Qgb2JqZWN0U2VyaWFsaXphdGlvbk1hcCA9IG5ldyBXZWFrTWFwKCk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gVmFsaWRhdGVkT2JqZWN0KCkgeyAgICBcclxuICAgIHJldHVybiAoY29uc3RydWN0b3IgOiBGdW5jdGlvbikgPT4ge1xyXG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnQFZhbGlkYXRlZE9iamVjdCBhcmdzOiBUYXJnZXQgLT4nICsgY29uc3RydWN0b3IubmFtZSk7XHJcbiAgICAgICAgY29uc3RydWN0b3IucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGV0IGpzb25SZXN1bHQgPSB7fTtcclxuICAgICAgICAgICAgLy8gRmlyc3QsIHdlIHdhbnQgdG8gc2VyaWFsaXplIGFsbCB0aGUgYmFzaWMgcHJvcGVydGllcyBmb3IgdGhpcyBpbnN0YW5jZVxyXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZVByb3BlcnR5S2V5cyA6IHN0cmluZ1tdID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcyk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlUHJvcGVydHlLZXlzLmZvckVhY2goKHYsaSxsKT0+e1xyXG4gICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICAgIGpzb25SZXN1bHRbdl0gPSB0aGlzW3ZdO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRoZW4gYWRkIGFsbCB0aGUgcHJvcGVydGllcyB0aGF0IGhhdmUgVmFsaWRhdG9ycyBhdHRhY2hlZCB0byB0aGVtXHJcbiAgICAgICAgICAgIGNvbnN0IG1hcCA9IG9iamVjdFNlcmlhbGl6YXRpb25NYXAuZ2V0KGNvbnN0cnVjdG9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BzID0gT2JqZWN0LmtleXMobWFwKTtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3BzLnJlZHVjZSgocHJldmlvdXMsIGtleSkgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhwcmV2aW91cykuZmluZEluZGV4KCh2LGksbCk9PnsgcmV0dXJuIHYgPT0ga2V5OyB9KSA+IC0xKSB7IHJldHVybiBwcmV2aW91czsgfVxyXG4gICAgICBcclxuICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcclxuICAgICAgICAgICAgICBwcmV2aW91c1ttYXBba2V5XV0gPSB0aGlzW2tleV07XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzO1xyXG4gICAgICAgICAgICB9LCBqc29uUmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRvckNvbmZpZyB7IGtleT86IFN5bWJvbDsgfVxyXG5cclxuY29uc3QgQUxMX1ZBTElEQVRPUl9DT05GSUdTIDogTWFwPFN5bWJvbCwgVmFsaWRhdG9yQ29uZmlnPiA9IG5ldyBNYXA8U3ltYm9sLCBWYWxpZGF0b3JDb25maWc+KCk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gTGlzdFZhbGlkYXRvckNvbmZpZ3MoKSB7XHJcbiAgICBsb2dnZXIuZGVidWcoJ0xJU1QgT0YgQUxMIFZBTElEQVRPUiBDT05GSUdVUkFUSU9OUycpO1xyXG4gICAgbG9nZ2VyLmRlYnVnKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nKTtcclxuICAgIEFMTF9WQUxJREFUT1JfQ09ORklHUy5mb3JFYWNoKCh2LGssbSk9PntcclxuICAgICAgICBsb2dnZXIuZGVidWcoJ0tleSA9ICcgKyBrLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnVmFsdWUgPSAnICsgSlNPTi5zdHJpbmdpZnkodikpO1xyXG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgfSk7XHJcbiAgICBsb2dnZXIuZGVidWcoJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBOdW1iZXJSYW5nZUNvbmZpZyBleHRlbmRzIFZhbGlkYXRvckNvbmZpZyB7XHJcbiAgICBtaW5pbXVtPzogbnVtYmVyO1xyXG4gICAgbWF4aW11bT86IG51bWJlcjtcclxuICAgIGRlZmF1bHRNaW5pbXVtPzogbnVtYmVyO1xyXG4gICAgZGVmYXVsdE1heGltdW0/OiBudW1iZXI7XHJcbn1cclxuICBcclxuZXhwb3J0IGZ1bmN0aW9uIE51bWJlclJhbmdlVmFsaWRhdG9yKGNvbmZpZzogTnVtYmVyUmFuZ2VDb25maWcpIHtcclxuICAgIHJldHVybiAodGFyZ2V0OiBhbnksIHByb3BlcnR5S2V5OiBzdHJpbmcgfCBzeW1ib2wpIDogYW55ID0+IHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoJ0BOdW1iZXJSYW5nZVZhbGlkYXRvciBhcmdzOicsIGB0YXJnZXQgLT4gJHt0YXJnZXQuY29uc3RydWN0b3IubmFtZX0sYCwgJ3Byb3BlcnR5S2V5IC0+JywgcHJvcGVydHlLZXkpO1xyXG4gICAgICAgIGlmIChjb25maWcuZGVmYXVsdE1pbmltdW0gPT09IHVuZGVmaW5lZCkgeyBjb25maWcuZGVmYXVsdE1pbmltdW0gPSAtMSAqIE51bWJlci5NQVhfVkFMVUU7IH1cclxuICAgICAgICBpZiAoY29uZmlnLmRlZmF1bHRNYXhpbXVtID09PSB1bmRlZmluZWQpIHsgY29uZmlnLmRlZmF1bHRNYXhpbXVtID0gTnVtYmVyLk1BWF9WQUxVRTsgfVxyXG5cclxuICAgICAgICAvLyBDcmVhdGUgYSBrZXkgZm9yIHN0b3JpbmcgdGhlIGNvbmZpZyBmb3IgdGhpcyBpbnN0YW5jZSB1c2luZyB0aGUgdGFyZ2V0IG5hbWUgYW5kIHRoZSBwcm9wZXJ0eUtleVxyXG4gICAgICAgIGNvbnN0IGtleSA9IHRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lICsgJy0nICsgcHJvcGVydHlLZXkudG9TdHJpbmcoKTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgbWFwID0gb2JqZWN0U2VyaWFsaXphdGlvbk1hcC5nZXQodGFyZ2V0KTtcclxuICAgICAgICBpZiAoIW1hcCkge1xyXG4gICAgICAgICAgICBtYXAgPSB7fTtcclxuICAgICAgICAgICAgb2JqZWN0U2VyaWFsaXphdGlvbk1hcC5zZXQodGFyZ2V0LCBtYXApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbWFwW3Byb3BlcnR5S2V5XSA9IHByb3BlcnR5S2V5O1xyXG5cclxuICAgICAgICAvLyBTdG9yZSB0aGUgY29uZmlnIGZvciB0aGlzIGluc3RhbmNlXHJcbiAgICAgICAgQUxMX1ZBTElEQVRPUl9DT05GSUdTW2tleV0gPSBjb25maWc7XHJcbiAgICAgICAgLy9MaXN0VmFsaWRhdG9yQ29uZmlncygpO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgdGhlIHJhbmdlIHZhbGlkYXRvciB1c2luZyB0aGUgY29uZmlnXHJcbiAgICAgICAgY29uc3QgbnVtYmVySXNJblJhbmdlID0gKG5ld1Byb3BlcnR5VmFsdWU6IG51bWJlcikgOiBib29sZWFuID0+IHtcclxuICAgICAgICAgICAgLy8gUmV0cmlldmUgdGhlIGNvbmZpZyBmcm9tIHN0b3JhZ2VcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbmZpZyA6IE51bWJlclJhbmdlQ29uZmlnfHVuZGVmaW5lZCA9IEFMTF9WQUxJREFUT1JfQ09ORklHU1trZXldO1xyXG4gICAgICAgICAgICBjb25zdCByYW5nZU1pbmltdW0gOiBudW1iZXIgPSAoY3VycmVudENvbmZpZyA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnRDb25maWcubWluaW11bSA9PT0gdW5kZWZpbmVkKSA/IC0xICogTnVtYmVyLk1BWF9WQUxVRSA6IGN1cnJlbnRDb25maWcubWluaW11bTtcclxuICAgICAgICAgICAgY29uc3QgcmFuZ2VNYXhpbXVtIDogbnVtYmVyID0gKGN1cnJlbnRDb25maWcgPT09IHVuZGVmaW5lZCB8fCBjdXJyZW50Q29uZmlnLm1heGltdW0gPT09IHVuZGVmaW5lZCkgPyBOdW1iZXIuTUFYX1ZBTFVFIDogY3VycmVudENvbmZpZy5tYXhpbXVtO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdudW1iZXJJc0luUmFuZ2UgOiB2YWx1ZSA9ICcgKyBuZXdQcm9wZXJ0eVZhbHVlICsgJywgbWluID0gJyArIHJhbmdlTWluaW11bSArICcsIG1heCA9ICcgKyByYW5nZU1heGltdW0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIChuZXdQcm9wZXJ0eVZhbHVlID49IHJhbmdlTWluaW11bSAmJiBuZXdQcm9wZXJ0eVZhbHVlIDw9IHJhbmdlTWF4aW11bSk7XHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIC8vIFdlIG5lZWQgYSB1bmlxdWUga2V5IGZvciBzdG9yaW5nIHRoZSBwcm9wZXJ0eSB2YWx1ZVxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWVTdG9yYWdlS2V5ID0gU3ltYm9sKCk7XHJcbiAgICBcclxuICAgICAgICAvLyBXZSBjYW4gcmV0dXJuIGEgcHJvcGVydHkgZGVzY3JpcHRvciB0aGF0IGlzIHVzZWQgdG8gZGVmaW5lIGEgcHJvcGVydHkgb24gdGhlIHRhcmdldCBnaXZlbiB0aGUgYHByb3BlcnR5S2V5YC5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSB2YWx1ZSBmcm9tIHRoZSB0YXJnZXQgaW5zdGFuY2UgdXNpbmcgdGhlIHVuaXF1ZSBzeW1ib2wgZnJvbSBhYm92ZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbcHJvcGVydHlWYWx1ZVN0b3JhZ2VLZXldOyBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0KG5ld1Byb3BlcnR5VmFsdWU6IGFueSkgeyBcclxuICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBjb25maWcgZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKG5ld1Byb3BlcnR5VmFsdWUpKSB7IHRocm93IG5ldyBFcnJvcihgUHJvcGVydHkgdmFsdWUgcHJvdmlkZWQgZm9yICR7a2V5fSBpcyBub3QgYSBudW1iZXI6ICR7bmV3UHJvcGVydHlWYWx1ZX1gKTsgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCAhIG51bWJlcklzSW5SYW5nZShuZXdQcm9wZXJ0eVZhbHVlKSkgeyB0aHJvdyBuZXcgRXJyb3IoYFByb3BlcnR5IHZhbHVlIHByb3ZpZGVkIGZvciAke2tleX0gaXMgbm90IGluIHRoZSB2YWxpZCByYW5nZTogJHtuZXdQcm9wZXJ0eVZhbHVlfSwgY29uZmlnOiAke2NvbmZpZ31gKTsgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBTYXZlIHRoaXMgbmV3IHZhbHVlIGJlY2F1c2UgaXQgaXMgdmFsaWRcclxuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHlWYWx1ZVN0b3JhZ2VLZXldID0gbmV3UHJvcGVydHlWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUZXh0Q29uZmlnIGV4dGVuZHMgVmFsaWRhdG9yQ29uZmlnIHtcclxuICAgIG1pbmltdW1MZW5ndGg/OiBudW1iZXI7XHJcbiAgICBtYXhpbXVtTGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgYWxsb3dMZWFkaW5nU3BhY2VzPzogYm9vbGVhbjtcclxuICAgIGFsbG93VHJhaWxpbmdTcGFjZXM/OiBib29sZWFuO1xyXG4gICAgY2hhcmFjdGVyU2V0UmVndWxhckV4cHJlc3Npb24/OiBSZWdFeHA7XHJcbn1cclxuICBcclxuZXhwb3J0IGZ1bmN0aW9uIFRleHRWYWxpZGF0b3IoY29uZmlnOiBUZXh0Q29uZmlnKSB7XHJcbiAgICByZXR1cm4gKHRhcmdldDogYW55LCBwcm9wZXJ0eUtleTogc3RyaW5nIHwgc3ltYm9sKSA6IGFueSA9PiB7XHJcbiAgICAgICAgbG9nZ2VyLmRlYnVnKCdAVGV4dFZhbGlkYXRvciBhcmdzOicsIGB0YXJnZXQgLT4gJHt0YXJnZXQuY29uc3RydWN0b3IubmFtZX0sYCwgJ3Byb3BlcnR5S2V5IC0+JywgcHJvcGVydHlLZXkpO1xyXG4gICAgICAgIGlmIChjb25maWcubWluaW11bUxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7IGNvbmZpZy5taW5pbXVtTGVuZ3RoID0gMDsgfVxyXG4gICAgICAgIGlmIChjb25maWcubWF4aW11bUxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7IGNvbmZpZy5tYXhpbXVtTGVuZ3RoID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7IH1cclxuICAgICAgICBpZiAoY29uZmlnLmFsbG93TGVhZGluZ1NwYWNlcyA9PT0gdW5kZWZpbmVkKSB7IGNvbmZpZy5hbGxvd0xlYWRpbmdTcGFjZXMgPSB0cnVlOyB9XHJcbiAgICAgICAgaWYgKGNvbmZpZy5hbGxvd1RyYWlsaW5nU3BhY2VzID09PSB1bmRlZmluZWQpIHsgY29uZmlnLmFsbG93VHJhaWxpbmdTcGFjZXMgPSB0cnVlOyB9XHJcbiAgICAgICAgaWYgKGNvbmZpZy5jaGFyYWN0ZXJTZXRSZWd1bGFyRXhwcmVzc2lvbiA9PT0gdW5kZWZpbmVkKSB7IGNvbmZpZy5jaGFyYWN0ZXJTZXRSZWd1bGFyRXhwcmVzc2lvbiA9IC9bXFxzXFxTXSovOyB9XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhIGtleSBmb3Igc3RvcmluZyB0aGUgY29uZmlnIGZvciB0aGlzIGluc3RhbmNlIHVzaW5nIHRoZSB0YXJnZXQgbmFtZSBhbmQgdGhlIHByb3BlcnR5S2V5XHJcbiAgICAgICAgY29uc3Qga2V5ID0gdGFyZ2V0LmNvbnN0cnVjdG9yLm5hbWUgKyAnLScgKyBwcm9wZXJ0eUtleS50b1N0cmluZygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBtYXAgPSBvYmplY3RTZXJpYWxpemF0aW9uTWFwLmdldCh0YXJnZXQpO1xyXG4gICAgICAgIGlmICghbWFwKSB7XHJcbiAgICAgICAgICAgIG1hcCA9IHt9O1xyXG4gICAgICAgICAgICBvYmplY3RTZXJpYWxpemF0aW9uTWFwLnNldCh0YXJnZXQsIG1hcCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBtYXBbcHJvcGVydHlLZXldID0gcHJvcGVydHlLZXk7XHJcblxyXG4gICAgICAgIC8vIFN0b3JlIHRoZSBjb25maWcgZm9yIHRoaXMgaW5zdGFuY2VcclxuICAgICAgICBBTExfVkFMSURBVE9SX0NPTkZJR1Nba2V5XSA9IGNvbmZpZztcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSB0ZXh0IHZhbGlkYXRvciB1c2luZyB0aGUgY29uZmlnXHJcbiAgICAgICAgY29uc3QgdGV4dElzVmFsaWQgPSAobmV3UHJvcGVydHlWYWx1ZTogc3RyaW5nKSA6IGJvb2xlYW4gPT4ge1xyXG4gICAgICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgY29uZmlnIGZyb20gc3RvcmFnZVxyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q29uZmlnIDogVGV4dENvbmZpZyA9IEFMTF9WQUxJREFUT1JfQ09ORklHU1trZXldO1xyXG5cclxuICAgICAgICAgICAgaWYgKCBjdXJyZW50Q29uZmlnLmFsbG93TGVhZGluZ1NwYWNlcyA9PT0gZmFsc2UgJiYgbmV3UHJvcGVydHlWYWx1ZS5zdGFydHNXaXRoKCcgJykgKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgICAgICBpZiAoIGN1cnJlbnRDb25maWcuYWxsb3dUcmFpbGluZ1NwYWNlcyA9PT0gZmFsc2UgJiYgbmV3UHJvcGVydHlWYWx1ZS5lbmRzV2l0aCgnICcpICkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgaWYgKCBjdXJyZW50Q29uZmlnLm1pbmltdW1MZW5ndGggPiAwICYmIG5ld1Byb3BlcnR5VmFsdWUubGVuZ3RoIDwgY3VycmVudENvbmZpZy5taW5pbXVtTGVuZ3RoICkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgaWYgKCBjdXJyZW50Q29uZmlnLm1heGltdW1MZW5ndGggPiAwICYmIG5ld1Byb3BlcnR5VmFsdWUubGVuZ3RoID4gY3VycmVudENvbmZpZy5tYXhpbXVtTGVuZ3RoICkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICAgICAgaWYgKCBjdXJyZW50Q29uZmlnLmNoYXJhY3RlclNldFJlZ3VsYXJFeHByZXNzaW9uLmV4ZWMobmV3UHJvcGVydHlWYWx1ZSkubGVuZ3RoICE9PSAxKSB7IHJldHVybiBmYWxzZTsgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGB0ZXh0SXNWYWxpZCA6IHZhbHVlID0gJyR7bmV3UHJvcGVydHlWYWx1ZX0nLCBtaW4gPSAke2N1cnJlbnRDb25maWcubWluaW11bUxlbmd0aH0sIG1heCA9ICR7Y3VycmVudENvbmZpZy5tYXhpbXVtTGVuZ3RofSwgbGVhZGluZ1NwYWNlcyA9ICR7Y3VycmVudENvbmZpZy5hbGxvd0xlYWRpbmdTcGFjZXN9LCB0cmFpbGluZ1NwYWNlcyA9ICR7Y3VycmVudENvbmZpZy5hbGxvd1RyYWlsaW5nU3BhY2VzfSwgY2hhcmFjdGVyU2V0UmVnZXggPSAke2N1cnJlbnRDb25maWcuY2hhcmFjdGVyU2V0UmVndWxhckV4cHJlc3Npb24uc291cmNlfWApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfTtcclxuICAgIFxyXG4gICAgICAgIC8vIFdlIG5lZWQgYSB1bmlxdWUga2V5IGZvciBzdG9yaW5nIHRoZSBwcm9wZXJ0eSB2YWx1ZVxyXG4gICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWVTdG9yYWdlS2V5ID0gU3ltYm9sKCk7XHJcbiAgICBcclxuICAgICAgICAvLyBXZSBjYW4gcmV0dXJuIGEgcHJvcGVydHkgZGVzY3JpcHRvciB0aGF0IGlzIHVzZWQgdG8gZGVmaW5lIGEgcHJvcGVydHkgb24gdGhlIHRhcmdldCBnaXZlbiB0aGUgYHByb3BlcnR5S2V5YC5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSB2YWx1ZSBmcm9tIHRoZSB0YXJnZXQgaW5zdGFuY2UgdXNpbmcgdGhlIHVuaXF1ZSBzeW1ib2wgZnJvbSBhYm92ZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbcHJvcGVydHlWYWx1ZVN0b3JhZ2VLZXldOyBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0KG5ld1Byb3BlcnR5VmFsdWU6IGFueSkgeyBcclxuICAgICAgICAgICAgICAgIC8vIFJldHJpZXZlIHRoZSBjb25maWcgZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICAgICAgICBpZiAoICEgdGV4dElzVmFsaWQobmV3UHJvcGVydHlWYWx1ZSkpIHsgdGhyb3cgbmV3IEVycm9yKGBQcm9wZXJ0eSB2YWx1ZSBwcm92aWRlZCBmb3IgJHtrZXl9IGlzIG5vdCB2YWxpZCB0ZXh0OiAke25ld1Byb3BlcnR5VmFsdWV9LCBjb25maWc6ICR7Y29uZmlnfWApOyB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhpcyBuZXcgdmFsdWUgYmVjYXVzZSBpdCBpcyB2YWxpZFxyXG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eVZhbHVlU3RvcmFnZUtleV0gPSBuZXdQcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Il19